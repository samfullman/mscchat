/*! Avaya Copyright js_client_sdk- v1.0.02018-05-30 */!function(a){"use strict";function b(){this.cobrowse=null,jQuery.fn.extend({getCPath:function(){if(1===this.length){for(var a,b=this;b.length;){var c=b[0],d=c.localName||c.tagName||c.nodeName;if(!d||"#document"===d)break;if(d=d.toLowerCase(),c.id){var e=c.id;return e=e.replace(/\./g,"\\."),d+"#"+e+(a?">"+a:"")}c.className&&(d+="."+c.className.split(/\s+/).join("."));d&&d.length>0&&"."===d.substring(d.length-1)&&(d=d.substring(0,d.length-1));var f=b.parent(),g=f.children(d);g.length>1&&(d+=":eq("+g.index(b)+")"),a=d+(a?">"+a:""),b=f}return a}}}),jQuery.fn.extend({getPath:function(a){if(a=jQuery.extend({full:!1,limit:!1},a),void 0===this.get(0).tagName)return!1;var b=$(this).get(0),c=[],d=0,e=0,f=!!$(b).closest("body").length,g=function(){var a=$(this).attr("id");if(a){if("function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(a){return-1!==this.indexOf(a,this.length-a.length)}),a.endsWith(".")||a.endsWith("#"))return"";a="#"+a}return a||""},h=function(){return this.tagName.toLowerCase()},i=function(){if(!this.parentNode)return"";var a=$(this.parentNode).children(this.tagName);return 1===a.length?"":":eq("+a.index(this)+")"};do{if(void 0===b.tagName)break;if(d++,!a.limit||e!==a.limit){e++;var j=g.call(b);if(j){if(c[c.length]=j,!a.full)break}else j=h.apply(b)+i.apply(b);c[c.length]=j,b=$(b).parent().get(0)}}while(b);return f||d!==e||"div"!==c[c.length-1]||c.splice(c.length-1,1),c.reverse().join(" > ")}})}b.prototype={createCustomerCobrowse:function(a){if(!a)throw"Cobrowse configuration is not defined.";return!this.cobrowse&&a.enabled&&(this.cobrowse=new b.Services.Cobrowse.Customer.CustomerCobrowse(a)),this.cobrowse},createAgentCobrowse:function(a){if(!a)throw"Cobrowse configuration is not defined.";return!this.cobrowse&&a.enabled&&(this.cobrowse=new b.Services.Cobrowse.Agent.AgentCobrowse(a)),this.cobrowse},registerLogger:function(a){b.Base.CobrowseLogger.addCobrowseLogger(a)}},a.AvayaCoBrowseClientServices=b}(window),function(a){"use strict";!function(a){a.Base=a.Base||{}}(a),function(a){a.Config=a.Config||{}}(a),function(a){a.Services=a.Services||{}}(a),function(a){a.Services.Cobrowse=a.Services.Cobrowse||{}}(a),function(a){a.Services.Cobrowse.Agent=a.Services.Cobrowse.Agent||{}}(a),function(a){a.Services.Cobrowse.Customer=a.Services.Cobrowse.Customer||{}}(a),function(a){a.Services.Cobrowse.Common=a.Services.Cobrowse.Common||{}}(a)}(AvayaCoBrowseClientServices),function(a){"use strict";!function(a){a.Providers=a.Providers||{}}(a),function(a){a.Providers.Cobrowse=a.Providers.Cobrowse||{}}(a),function(a){a.Providers.Cobrowse.Customer=a.Providers.Cobrowse.Customer||{}}(a),function(a){a.Providers.Cobrowse.Agent=a.Providers.Cobrowse.Agent||{}}(a)}(AvayaCoBrowseClientServices),function(a){"use strict";var b={set:function(a,b,c,d){var e;if(d){var f=new Date;f.setTime(f.getTime()+24*d*60*60*1e3),e="; expires="+f.toGMTString()}else e="";document.cookie=c?a+"="+b+e+"; path=/; domain="+c:a+"="+b+e+"; path=/"},get:function(a){for(var b,c=a+"=",d=document.cookie.split(";"),e=0;e<d.length;e++){for(b=d[e];" "===b[0];)b=b.substring(1,b.length);if(0===b.indexOf(c))return b.substring(c.length,b.length)}return null},erase:function(a,b){this.set(a,"",b,-1)}};a.Base.CobrowseCookie=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";var b={"CB.INACTIVE_TIMEOUT_MESSAGE":"","CB.SESSION_TIMEOUT":"","CB.INACTIVE_TIMEOUT":""};a.Base.CobrowseDataOptions=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(){this.passPhrase=void 0,this.externalKey=void 0,this.cobrowseState=void 0,this.agentControlState=void 0,this.transcript=void 0,this.sessionStartTime=void 0,this.cobrowsedUrl=void 0,this.apiKey=void 0,this.sessionLocale=void 0,this.securityIp=void 0,this.agentName=void 0,this.agtProtocolToConnect=void 0,this.agtStartTime=void 0,this.agtAuthCode=void 0,this.agtRegisteredUi=void 0,this.agtReasonForDisconnect=void 0,this.agtPhotoUrl=void 0,this.agtUserAgent=void 0,this.customerName=void 0,this.custProtocolToConnect=void 0,this.custStartTime=void 0,this.custAuthCode=void 0,this.custRegisteredUi=void 0,this.custReasonForDisconnect=void 0,this.custPhotoUrl=void 0,this.custUserAgent=void 0,this.custSessionTransferInProgress=void 0}b.prototype={getPassPhrase:function(){return this.passPhrase},getCobrowseState:function(){return this.cobrowseState},getAgentControlState:function(){return this.agentControlState},getAgentName:function(){return this.agentName},getAgentAuthCode:function(){return this.agtAuthCode},getAgentReasonForDisconnect:function(){return this.agtReasonForDisconnect},getCustomerName:function(){return this.customerName},getCustomerAuthCode:function(){return this.custAuthCode},getCustomerReasonForDisconnect:function(){return this.custReasonForDisconnect}},a.Base.CobrowseSessionInfo=b}(AvayaCoBrowseClientServices),function(a,b){"use strict";function c(c){this.isAllowed=c===a.Base.CobrowseCapabilityDenialReason.CAPABILITY_NOT_DENIED,this.denialReason=c,this._onChangedCallbacks=b.Callbacks()}c.prototype={addOnChangedCallback:function(a){this._onChangedCallbacks.add(a)},removeOnChangedCallback:function(a){this._onChangedCallbacks.remove(a)},_updateIfChanged:function(a,b){this.isAllowed===a&&this.denialReason===b||(this.isAllowed=a,this.denialReason=b,this._onChangedCallbacks.fire(this))}},a.Base.CoBrowseCapability=c}(AvayaCoBrowseClientServices,jQuery),function(a){"use strict";var b={CAPABILITY_NOT_DENIED:"CAPABILITY_NOT_DENIED",CAPABILITY_INVALID_STATE:"CAPABILITY_INVALID_STATE"};a.Base.CobrowseCapabilityDenialReason=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(){this.passPhrase=void 0,this.authKey=void 0,this.superVisor=void 0,this.coBrowseSessionInfo=new a.Base.CobrowseSessionInfo,this.options={},this.redirectURL=void 0}a.Base.CobrowseData=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(a){this.dataSet=a,this.dataRetrievalProgress=$.Callbacks(),this.dataRetrievalDone=$.Callbacks(),this.dataRetrievalFailed=$.Callbacks()}b.prototype={getCobrowseDataSet:function(){return this.dataSet},addOnCobrowseDataRetrievalProgressCallback:function(a){this.dataRetrievalProgress.add(a)},removeOnCobrowseDataRetrievalProgressCallback:function(a){this.dataRetrievalProgress.remove(a)},onCobrowseDataRetrievalProgress:function(a,b,c){this.dataRetrievalProgress.fire(this,arguments)},addOnCobrowseDataRetrievalDoneCallback:function(a){this.dataRetrievalDone.add(a)},removeOnCobrowseDataRetrievalDoneCallback:function(a){this.dataRetrievalDone.remove(a)},onCobrowseDataRetrievalDone:function(){this.dataRetrievalDone.fire(this,arguments)},addOnCobrowseDataRetrievalFailedCallback:function(a){this.dataRetrievalFailed.add(a)},removeOnCobrowseDataRetrievalFailedCallback:function(a){this.dataRetrievalFailed.remove(a)},onCobrowseDataRetrievalFailed:function(a){this.dataRetrievalFailed.fireWith(this,arguments)}},a.Base.CobrowseDataRetrieval=b}(AvayaCoBrowseClientServices),function(a,b){"use strict";function c(){this.dataSetChangeCallbacks=b.Callbacks(),this.dataSetInvalidatedCallbacks=b.Callbacks(),this.coBrowseData=new a.Base.CobrowseData}c.prototype=Object.create(a.Base.CobrowseData.prototype),c.prototype.updateDataset=function(a){b.extend(this.coBrowseData,a)},c.prototype.addOnCobrowseDataSetChangedCallback=function(a){this.dataSetChangeCallbacks.add(a)},c.prototype.removeOnCobrowseDataSetChangedCallback=function(a){this.dataSetChangeCallbacks.remove(a)},c.prototype.onCobrowseDataSetChanged=function(){this.dataSetChangeCallbacks.fire(this)},c.prototype.addOnCobrowseDataSetInvalidatedCallback=function(a){this.dataSetInvalidatedCallbacks.add(a)},c.prototype.removeOnCobrowseDataSetInvalidatedCallback=function(a){this.dataSetInvalidatedCallbacks.remove(a)},c.prototype.onCobrowseDataSetInvalidated=function(){this.dataSetInvalidatedCallbacks.fire(this)},a.Base.CobrowseDataSet=c}(AvayaCoBrowseClientServices,jQuery),function(a){"use strict";function b(a,b,c){Error.call(this,c),this._errorCode=a,this._reason=b,this._message=c}b.prototype=Object.create(Error.prototype),b.prototype.getErrorCode=function(){return this._errorCode},b.prototype.getReason=function(){return this._reason},b.prototype.getMessage=function(){return this._message},a.Base.CoBrowseError=b}(AvayaCoBrowseClientServices),function(){"use strict";function a(a,b,c,d){void 0!==d?a[b](c,d):a[b](c)}function b(a,b,c,d){void 0!==d?a.log(b,c,d):a.log(b,c)}var c=[];AvayaCoBrowseClientServices.Base.CobrowseLogger={log:function(a,d,e){c.forEach(function(c){b(c,a,d,e)})},info:function(d,e){c.forEach(function(c){"function"==typeof c.info?a(c,"info",d,e):b(c,"info",d,e)})},error:function(d,e){c.forEach(function(c){"function"==typeof c.error?a(c,"error",d,e):b(c,"error",d,e)})},fatal:function(d,e){c.forEach(function(c){"function"==typeof c.fatal?a(c,"fatal",d,e):b(c,"fatal",d,e)})},debug:function(d,e){c.forEach(function(c){"function"==typeof c.debug?a(c,"debug",d,e):b(c,"debug",d,e)})},trace:function(d,e){c.forEach(function(c){"function"==typeof c.trace?a(c,"trace",d,e):b(c,"trace",d,e)})},warn:function(d,e){c.forEach(function(c){"function"==typeof c.warn?a(c,"warn",d,e):b(c,"warn",d,e)})},addCobrowseLogger:function(a){if(!a||void 0===a.log)throw new TypeError("CobrowseLogger should implement log method.");c.push(a)},removeCobrowseLogger:function(a){var b=c.indexOf(a);if(-1===b)throw new Error("Specified error does not exist.");c.splice(b,1)}}}(),function(a,b){"use strict";function c(){this._listeners={}}c.prototype={on:function(a,b){return"function"!=typeof b?this:(this._listeners[a]=this._listeners[a]||[],this._listeners[a].push(b),this)},off:function(a,b){if("function"!=typeof b)return this;if(void 0===this._listeners[a])throw new Error("There is no such handler for event with name: "+a+".");var c=this._listeners[a].indexOf(b);if(-1===c)throw new Error("There is no such handler for event with name: "+a+".");return this._listeners[a].splice(c,1),this},trigger:function(a,c,d){var e=this._listeners[a];void 0!==e&&(c=c||[],b.each(e,function(a,b){d?b.call(d,c):b.call(window,c)}))},_removeListeners:function(){for(var a in this._listeners)if(this._listeners.hasOwnProperty(a))for(var b=0;b<this._listeners[a].length;b++)this.off(a,this._listeners[a][b])}},a.Base.Observable=c}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{},jQuery||{}),function(a){"use strict";function b(){}b.prototype={state:function(){},always:function(b){"function"!=typeof b&&a.Base.CobrowseLogger.warn("alwaysCallback is not a function")},done:function(b){"function"!=typeof b&&a.Base.CobrowseLogger.warn("doneCallback is not a function")},fail:function(b){"function"!=typeof b&&a.Base.CobrowseLogger.warn("failCallback is not a function")},progress:function(b){"function"!=typeof b&&a.Base.CobrowseLogger.warn("progressCallback is not a function")},then:function(b,c,d){"function"!=typeof b?a.Base.CobrowseLogger.warn("doneCallback is not a function"):"function"!=typeof c?a.Base.CobrowseLogger.warn("failCallback is not a function"):"function"!=typeof d&&a.Base.CobrowseLogger.warn("progressCallback is not a function")}},a.Base.CobrowsePromise=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(){this._config={},this._credentialProvider={}}b.prototype={start:function(b,c,d){this._config=b,this._credentialProvider=c,this.onOpen(),d&&a.Base.CobrowseLogger.info(d)},send:function(b,c){c&&a.Base.CobrowseLogger.info(c),b&&a.Base.CobrowseLogger.info(b)},_onCredentialsRequired:function(b){b&&a.Base.CobrowseLogger.info(b)},close:function(){this.onClose()},onOpen:function(){},onClose:function(){},onMessage:function(b){b&&a.Base.CobrowseLogger.info(b)},onError:function(b){a.Base.CobrowseLogger.error(b)}},a.Base.AbstractNetworkProvider=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(a){this._sockJSNetowrkProvider=a,this.idCounter=1,this.resultListeners=[],this.notificationListeners=[],this.notificationListenersObjectOwner=[]}b.prototype.start=function(a){this._sockJSNetowrkProvider=a},b.prototype.attach=function(b,c,d,e){var f=b+"."+c;this.notificationListeners[f]&&(a.Base.CobrowseLogger.warn("multiple listeners for event: "+f),delete this.notificationListeners[f]),this.notificationListenersObjectOwner[f]&&(a.Base.CobrowseLogger.warn("multiple listeners for event: "+f),delete this.notificationListenersObjectOwner[f]),a.Base.CobrowseLogger.info("listener registered for event: "+f),this.notificationListeners[f]=d,this.notificationListenersObjectOwner[f]=e},b.prototype.detach=function(a,b){var c=a+"."+b;delete this.notificationListeners[c],delete this.notificationListenersObjectOwner[c]},b.prototype.call=function(){var a=Array.prototype.slice.call(arguments);if(!(a.length<2)){var b=a[0],c=a[1],d=null,e=null;a.length>2&&"function"==typeof a[a.length-1]&&(d=a.pop(),a.length>2&&"function"==typeof a[a.length-1]&&(e=d,d=a.pop()));var f=null;a.length>2&&(f=a.slice(2));var g={jsonrpc:"2.0",service:b,method:c,params:f};return d&&(g.id=this.idCounter++,this.resultListeners[g.id]={success:d,failure:e}),this._sockJSNetowrkProvider.send(JSON.stringify(g)),g.id}},b.prototype.send=function(a,b,c,d){if(!(Array.prototype.slice.call(arguments).length<2)){var e=a,f=b,g=c,h={jsonrpc:"2.0",service:e,method:f,params:g};return d&&(h.id=this.idCounter++,this.resultListeners[h.id]={deffered:d}),this._sockJSNetowrkProvider.send(JSON.stringify(h)),h.id}},b.prototype.evtOnMessageHandler=function(b){var c,d=JSON.parse(b);if("2.0"===d.jsonrpc){if(null!==d.result&&void 0!==d.result)return d.id?(c=this.resultListeners[d.id])?(delete this.resultListeners[d.id],c.deffered?(c.deffered.resolve(d.result),c.deffered.promise()):void c.success(d.result)):void a.Base.CobrowseLogger.error("Invalid ID"):void a.Base.CobrowseLogger.error("Message ID not found");if(d.error)return d.id?(c=this.resultListeners[d.id])?(delete this.resultListeners[d.id],c.failure||c.deffered?c.deffered?(c.deffered.reject(d.error),c.deffered.promise()):void c.failure(d.error):void a.Base.CobrowseLogger.info("Ignore. No error callback for message")):void a.Base.CobrowseLogger.error("Invalid id"):void a.Base.CobrowseLogger.info("Ignore. Message ID not found");if(d.method){var e=this.notificationListeners[d.method],f=this.notificationListenersObjectOwner[d.method],g=0;e?f?e.apply(f,d.params):e.apply(window,d.params):g=-32601,d.id&&(c={jsonrpc:"2.0"},0!==g?c.error={code:g,message:"Method not found"}:c.result="",c.id=d.id,this._sockJSNetowrkProvider.send(JSON.stringify(c)))}}},a.Base.JsonRPCProvider=b}(AvayaCoBrowseClientServices),function(a,b){"use strict";function c(){a.Base.AbstractNetworkProvider.apply(this),this._xhrPool=[]}c.prototype=Object.create(a.Base.AbstractNetworkProvider.prototype),c.prototype.defaultOptions={url:void 0,sendType:"POST",urlSuffix:"",dataType:"text",headers:{},processData:!0},c.prototype.send=function(c,d,e,f){var g=b.extend({},this.defaultOptions,d),h=this._getServerURL(g),i={url:h,type:g.sendType,dataType:g.dataType,headers:g.headers,processData:g.processData,beforeSend:function(b){this._xhrPool.push(b),a.Base.CobrowseLogger.info("IN - "+JSON.stringify(b))}.bind(this)};if(c&&(i.data=c),g.crossDomain&&!0===g.crossDomain&&(i.xhrFields={withCredentials:!0},i.crossDomain=!0),a.Base.CobrowseLogger.info("OUT - "+JSON.stringify(i)),g.authentication&&"Basic"===g.authentication.type){var j="Basic "+btoa(g.authentication.username+":"+g.authentication.password);i.beforeSend=function(a){a.setRequestHeader("Authorization",j),this._xhrPool.push(a)}.bind(this)}return b.ajax(!0===e?i:this._buildAuthorizationHeader(i,f)).then(function(b,c,d){return this._xhrPool.splice(this._xhrPool.indexOf(d),1),a.Base.CobrowseLogger.info("Success - "+JSON.stringify(b)),this.onMessage(b,d),b}.bind(this),function(b){return this.onError(b),a.Base.CobrowseLogger.error(b),b}.bind(this))},c.prototype._buildAuthorizationHeader=function(a,b){var c=b;return a.headers.Authorization="Bearer "+c,a},c.prototype._getServerURL=function(a){var b="";return void 0!==a.url?b=a.url:(b+=this._config.isSecure?"https://":"http://",b+=this._config.hostName+":"+this._config.port,b+=a.urlSuffix),b},c.prototype.close=function(){this._xhrPool.forEach(function(a){a.abort()}),this._xhrPool=[],this.onClose()},a.Base.RESTProvider=c}(AvayaCoBrowseClientServices,jQuery),function(a){"use strict";function b(){a.Base.AbstractNetworkProvider.apply(this),this._sockJSConn=void 0,this._isOpened=!1,this._errorCount=0,this._isShutdown=!1,this._cbprotocols=["xhr-polling","xdr-polling"],this._options={transports:this._cbprotocols}}b.prototype=Object.create(a.Base.AbstractNetworkProvider.prototype),b.prototype.onConnectionUnavailable=function(){},b.prototype.start=function(a,b){if(this._isOpened)this.onOpen();else{if(this._config=a,this._isShutdown=!1,void 0===SockJS)return void this.onConnectionUnavailable();this._createSockJSConnection(b)}},b.prototype.send=function(a){var b=$.Deferred();return this.isOpened()?(this._sockJSConn.send(a),b.resolve()):b.reject("Socket is not opened!"),b.promise()},b.prototype.close=function(){this._isShutdown=!0,this._isOpened?(this._sockJSConn.close(),this._isOpened=!1):this._sockJSConn&&this.onClose(),this._errorCount=0,this._sockJSConn=void 0},b.prototype.isOpened=function(){return this._isOpened&&1===this._sockJSConn.readyState},b.prototype._getServerURL=function(a){var b="";return a&&void 0!==a.url?b=a.url:(b+=this._config.isSecure?"https://":"http://",b+=this._config.hostName,this._config.port&&(b+=":"+this._config.port)),a&&void 0!==a.urlSuffix&&(b+=a.urlSuffix),b},b.prototype._createSockJSConnection=function(a){this._isOpening=!0,this._sockJSConn=new SockJS(this._getServerURL(a),null,this._options),this._sockJSConn.onopen=function(){this._isOpening=!1,this._isShutdown?this._sockJSConn.close():(this._isOpened=!0,this._errorCount=0,this.onOpen())}.bind(this),this._sockJSConn.onmessage=function(a){this.onMessage(a)}.bind(this),this._sockJSConn.onclose=function(a){this._isOpening||(this._isOpened=!1,this._sockJSConn=void 0,this.onClose(a))}.bind(this),this._sockJSConn.onerror=function(a){this.onError(a)}.bind(this)},b.prototype._handleReconnect=function(a,b){this._isOpened||(this._errorCount+=1,this._errorCount>=this._config.maxConnectionErrorCount||this._isShutdown?(this._isOpening=!1,this.onConnectionUnavailable(a)):this._createSockJSConnection(b))},b.prototype.getProtocol=function(){return this._sockJSConn?this._sockJSConn.protocol:(a.Base.CobrowseLogger.error("Connection is not defined, Unable to tell protocol"),null)},a.Base.SockJSNetowrkProvider=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(){this.enabled=!1,this.serverInfo=new a.Config.ServerInfo,this.maxConnectionErrorCount=5,this.isGuest=!0,this.token=""}b.prototype={},a.Config.CoBrowseConfiguration=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(){this.hostName="",this.port=0,this.isSecure=!1}b.prototype={},a.Config.ServerInfo=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(){this._cobrowseNetworkProvider=new a.Providers.Cobrowse.CobrowseNetworkProvider,this._cobrowseConfig=null}b.prototype={start:function(b){this._cobrowseConfig=b,this._cobrowseNetworkProvider.init(this._cobrowseConfig.serverInfo);var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Agent.AgentCobrowseURLProvider.SERVERSTATUSURL,this._cobrowseNetworkProvider.send({},c,this._cobrowseConfig.isGuest,this._cobrowseConfig.token)},startSocketConnection:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;c.urlSuffix=b||a.Providers.Cobrowse.Agent.AgentCobrowseURLProvider.SOCKETSERVICEURL,this._cobrowseNetworkProvider.startSocketConnection(c)},stopSocketConnection:function(){this._cobrowseNetworkProvider.stop()},requestSession:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Agent.AgentCobrowseURLProvider.REQUESTURL,this._cobrowseNetworkProvider.send(b,c,this._cobrowseConfig.isGuest,this._cobrowseConfig.token)},joinSession:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Agent.AgentCobrowseURLProvider.JOINURL,this._cobrowseNetworkProvider.send(b,c,this._cobrowseConfig.isGuest,this._cobrowseConfig.token)},joinLiveSession:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Agent.AgentCobrowseURLProvider.LIVEJOINURL,this._cobrowseNetworkProvider.send(b,c,this._cobrowseConfig.isGuest,this._cobrowseConfig.token)},statusSession:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Agent.AgentCobrowseURLProvider.STATUSURL,this._cobrowseNetworkProvider.send(b,c,this._cobrowseConfig.isGuest,this._cobrowseConfig.token)},logoutSession:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Agent.AgentCobrowseURLProvider.LOGOUTURL,this._cobrowseNetworkProvider.send(b,c,this._cobrowseConfig.isGuest,this._cobrowseConfig.token)},callJsonRPC:function(){return this._cobrowseNetworkProvider.callJsonRPC.apply(this._cobrowseNetworkProvider,arguments)},sendJsonRPC:function(a,b,c,d){return this._cobrowseNetworkProvider.sendJsonRPC.call(this._cobrowseNetworkProvider,a,b,c,d)},attachNetworkEvent:function(a,b){return this._cobrowseNetworkProvider.on(a,b)},registerServerCallback:function(a,b,c){this._cobrowseNetworkProvider.attach("agentservice",a,b,c)}},a.Providers.Cobrowse.Agent.AgentCobrowseProvider=b}(AvayaCoBrowseClientServices),function(a){"use strict";var b={SERVERSTATUSURL:"/services/CoBrowse/v1/server/status",REQUESTURL:"/services/CoBrowse/v1/agent/session/request",JOINURL:"/services/CoBrowse/v1/agent/session/join",LIVEJOINURL:"/services/CoBrowse/v1/agent/session/live/join",STATUSURL:"/services/CoBrowse/v1/agent/status",LOGOUTURL:"/services/CoBrowse/v1/agent/session/logout",SOCKETSERVICEURL:"/services/CoBrowse/sockjs/cobrowse/agent"};a.Providers.Cobrowse.Agent.AgentCobrowseURLProvider=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";var b={url:void 0,sendType:"GET",urlSuffix:"/services/CoBrowse/v1/server/status",dataType:"JSON",headers:{},processData:!0};a.Providers.Cobrowse.CobrowseNetworkOptions=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a,b){"use strict";function c(b,c){a.Base.Observable.apply(this),this._restProvider=b,this._sockJSNetworkProvider=c,this._jsonProvider=void 0,this._config=void 0}c.prototype=Object.create(a.Base.Observable.prototype),c.prototype.addTrigger=function(b){this._sockJSNetworkProvider.onMessage=function(c){if("string"==typeof c.data){if("keepalive"===c.data)return void a.Base.CobrowseLogger.info("IN - keepalive: "+JSON.stringify(c));a.Base.CobrowseLogger.info("IN - "+JSON.stringify(c)),b.trigger(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_MESSAGE,c.data,b._jsonProvider)}else b.trigger(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_MESSAGE,c.data)},this._sockJSNetworkProvider.onError=function(c){a.Base.CobrowseLogger.error("OnError: "+c),b.trigger(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_ERROR)},this._sockJSNetworkProvider.onOpen=function(){b._jsonProvider=new a.Base.JsonRPCProvider(b._sockJSNetworkProvider),b.addSockJSHandler(b),b.trigger(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_OPEN)},this._sockJSNetworkProvider.onClose=function(c){b.trigger(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_CLOSE,{wasClean:c.wasClean,code:c.code,reason:c.reason}),b._removeListeners(),b._jsonProvider=void 0}},c.prototype.addSockJSHandler=function(b){var c=b._jsonProvider.evtOnMessageHandler;b.on(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_MESSAGE,c)},c.prototype.init=function(b){this._config=b,this._restProvider||(this._restProvider=new a.Base.RESTProvider),this._sockJSNetworkProvider||(this._sockJSNetworkProvider=new a.Base.SockJSNetowrkProvider),this._restProvider._config=this._config,this._sockJSNetworkProvider._config=this._config},c.prototype.startSocketConnection=function(a){this.addTrigger(this),this._sockJSNetworkProvider.start(this._config,a)},c.prototype.stop=function(){this._sockJSNetworkProvider&&(this._removeListeners(),this._sockJSNetworkProvider.close())},c.prototype.send=function(b,c,d,e){return this._restProvider.send(b,c,d,e).then(function(a){return a},function(b){return a.Base.CobrowseLogger.log("error in rest sending"),this._handleError(b)}.bind(this))},c.prototype.callJsonRPC=function(){return this._jsonProvider.call.apply(this._jsonProvider,arguments)},c.prototype.sendJsonRPC=function(a,c,d){var e=b.Deferred(),f=function(a){e.resolve(a)},g=function(a){e.reject(this._handleError(a))};return this._jsonProvider.send.call(this._jsonProvider,a,c,d,e),e.then(f.bind(this),g.bind(this)),e.promise()},c.prototype.attach=function(a,b,c,d){this._jsonProvider.attach(a,b,c,d)},c.prototype.detach=function(a,b){this._jsonProvider.detach(a,b)},c.prototype.getProtocol=function(){this._sockJSNetworkProvider.getProtocol.call(this._sockJSNetworkProvider)},c.prototype._handleError=function(b){var c="Unknown Code",d="Unknown Reason",e="Unknown Error";if(!b)return new a.Base.CoBrowseError(c,d,e);if(d=b,b.errorMessage)e=b.errorMessage,b.errorCode&&(c=b.errorCode);else if(b.data){var f=b.data.split("::");f.length>1&&(e=f[1],c=f[0])}if(b){if(c=b.status?b.status:"Unknown Code",b.readyState<4)d=a.Services.Cobrowse.Common.CobrowseErrorReason.SERVER_UNAVAILABLE,e="Connection to Cobrowse service failed";else if(4===b.readyState)switch(b.status){case 401:d=a.Services.Cobrowse.Common.CobrowseErrorReason.AUTHENTICATION_FAILED,e="Authentication failed";break;case 404:d=a.Services.Cobrowse.Common.CobrowseErrorReason.COBROWSE_URL_NOT_FOUND,e="Cobrowse URL was not found";break;case 504:d=a.Services.Cobrowse.Common.CobrowseErrorReason.REQUEST_TIMEOUT,e="Request to server has timed out";break;case 503:d=a.Services.Cobrowse.Common.CobrowseErrorReason.RETRY,e="Server is busy";break;default:b.status>=400&&b.status<500?(e="Unknown Client Error",d=a.Services.Cobrowse.Common.CobrowseErrorReason.UNKNOWN_REASON):b.status>=500&&b.status<600&&(d=a.Services.Cobrowse.Common.CobrowseErrorReason.SERVER_UNAVAILABLE,e="Unknown Cobrowse Server Error")}}else d=a.Services.Cobrowse.Common.CobrowseErrorReason.UNKNOWN_REASON;return a.Base.CobrowseLogger.error(JSON.stringify(b)),new a.Base.CoBrowseError(c,d,e)},a.Providers.Cobrowse.CobrowseNetworkProvider=c}(AvayaCoBrowseClientServices,jQuery),function(a){"use strict";var b={SOCKET_ON_OPEN:"cbprovider.onOpen",SOCKET_ON_CLOSE:"cbprovider.onClose",SOCKET_ON_MESSAGE:"cbprovider.onMessage",SOCKET_ON_ERROR:"cbprovider.onError"};a.Providers.Cobrowse.ObservableEvents=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";function b(){this._cobrowseNetworkProvider=new a.Providers.Cobrowse.CobrowseNetworkProvider,this._cobrowseConfig=null}b.prototype={init:function(b){this._cobrowseConfig=b,this._cobrowseNetworkProvider.init(this._cobrowseConfig.serverInfo);var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Customer.CustomerCobrowseURLProvider.SERVERSTATUSURL,this._cobrowseNetworkProvider.send({},c,this._cobrowseConfig.isGuest,this._cobrowseConfig.token)},startSocketConnection:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;c.urlSuffix=b||a.Providers.Cobrowse.Customer.CustomerCobrowseURLProvider.SOCKETSERVICEURL,this._cobrowseNetworkProvider.startSocketConnection(c)},stopSocketConnection:function(){this._cobrowseNetworkProvider.stop()},requestSession:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Customer.CustomerCobrowseURLProvider.REQUESTURL,this._cobrowseNetworkProvider.send(b,c,this._cobrowseConfig.isGuest,this._cobrowseConfig.token)},joinSession:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Customer.CustomerCobrowseURLProvider.JOINURL,this._cobrowseNetworkProvider.send(b,c,this._cobrowseConfig.isGuest,this._cobrowseConfig.token)},statusSession:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Customer.CustomerCobrowseURLProvider.STATUSURL,this._cobrowseNetworkProvider.send(b,c,this._cobrowseConfig.isGuest,this._cobrowseConfig.token)},logoutSession:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Customer.CustomerCobrowseURLProvider.LOGOUTURL,this._cobrowseNetworkProvider.send(b,c,this._cobrowseConfig.isGuest,this._cobrowseConfig.token)},callJsonRPC:function(){return this._cobrowseNetworkProvider.callJsonRPC.apply(this._cobrowseNetworkProvider,arguments)},sendJsonRPC:function(a,b,c,d){return this._cobrowseNetworkProvider.sendJsonRPC.call(this._cobrowseNetworkProvider,a,b,c,d)},attachNetworkEvent:function(a,b){return this._cobrowseNetworkProvider.on(a,b)},registerServerCallback:function(b,c,d){this._cobrowseNetworkProvider.attach(a.Services.Cobrowse.Common.CobrowseConstants.CUSTOMERSERVICE,b,c,d)},getProtocol:function(){this._cobrowseNetworkProvider.getProtocol.call(this._cobrowseNetworkProvider)}},a.Providers.Cobrowse.Customer.CustomerCobrowseProvider=b}(AvayaCoBrowseClientServices),function(a){"use strict";var b={SERVERSTATUSURL:"/services/CoBrowse/v1/server/status",REQUESTURL:"/services/CoBrowse/v1/customer/session/request",JOINURL:"/services/CoBrowse/v1/customer/session/join",STATUSURL:"/services/CoBrowse/v1/customer/status",LOGOUTURL:"/services/CoBrowse/v1/customer/session/logout",SOCKETSERVICEURL:"/services/CoBrowse/sockjs/cobrowse/customer"};a.Providers.Cobrowse.Customer.CustomerCobrowseURLProvider=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";function b(){this._mPtr=void 0,this._titleNode=void 0,this._mask=void 0,this._mLocalNode=void 0,this._scrollTopOld=0,this._scrollLeftOld=0}a.Services.Cobrowse.Agent.AgentCobrowsePageData=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";function b(b){this._agentCobrowseProvider=new a.Providers.Cobrowse.Agent.AgentCobrowseProvider,this._agentCobrowse=b,this._cobrowseConfig=null,this._hoverCollection=null,this._agentCoBrowseDataSet=new a.Base.CobrowseDataSet,a.Services.Cobrowse.Agent.AgentCobrowseServiceData.apply(this),a.Base.Observable.apply(this)}b.prototype=Object.create(a.Base.Observable.prototype),b.prototype.updateData=function(a){var b=this.getAgentDataSet().coBrowseData;$.extend(b.coBrowseSessionInfo,a.acsResponse.coBrowseSessionInfo),$.extend(b.options,a.options),b.passPhrase=a.acsResponse.passPhrase,b.authKey=a.acsResponse.authKey,b.superVisor=a.acsResponse.superVisor,this.getAgentDataSet().updateDataset(b)},b.prototype.getAgentDataSet=function(){return this._agentCoBrowseDataSet},b.prototype.start=function(a){return this._cobrowseConfig=a,this._agentCobrowseProvider.start(this._cobrowseConfig)},b.prototype.startSocketConnection=function(){var b=this;if(b.getAgentDataSet().coBrowseData.redirectURL){var c=a.Providers.Cobrowse.Agent.AgentCobrowseURLProvider.SOCKETSERVICEURL+"/?affinity="+b.getAgentDataSet().coBrowseData.redirectURL;b._agentCobrowseProvider.startSocketConnection(c)}else b._agentCobrowseProvider.startSocketConnection()},b.prototype.stopSocketConnection=function(){this._agentCobrowseProvider.stopSocketConnection()},b.prototype.setMousePointerOffset=function(a,b){this._mXrOffset=a,this._mYrOffset=b},b.prototype.setIFrame=function(a){this._iframeDivID=a,this._iframeDivSelector="#"+this._iframeDivID},b.prototype.enableTitle=function(a){this._isTitleEnable=a},b.prototype.enableHighlight=function(a){this._isHighilightEnabled=a},b.prototype.setAgentCSSPath=function(a){this._agentCSSPath=a},b.prototype.setAgentImagePath=function(a){this._agentImagePath=a},b.prototype.setRetryAttempts=function(a){this._retryAttemps=a},b.prototype.setConnectionRetryInterval=function(a){
this._connRetryInterval=a},b.prototype.setMouseAndScrollSyncInterval=function(a){this._mmSyncInterval=a},b.prototype.setWorkRequestId=function(a){this._workRequestId=a},b.prototype.requestSession=function(b){var c=$.Deferred(),d=this,e=function(b){b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSSTATUSCODE&&b.acsResult===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSRESULT?(d.getAgentDataSet().coBrowseData=new a.Base.CobrowseData,d.updateData(b),a.Base.CobrowseCookie.set("AGENT_ACS_TOKEN",d.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,null),c.resolve(d.getAgentDataSet().coBrowseData.coBrowseSessionInfo)):b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.FAILSTATUSCODE&&c.reject(new a.Base.CoBrowseError(b.errorCode,b.errorMessage,b.errorMessage))},f=function(a){d.onFailure(a,c)};return b.workrequestid=this._workRequestId,this._agentCobrowseProvider.requestSession(b).then(e,f),c.promise()},b.prototype.joinSession=function(b){var c=this,d=$.Deferred(),e=!0,f=function(a){c.onFailure(a,d)},g=function(h){if(h&&h.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSSTATUSCODE&&h.acsResult===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSRESULT){var i=c.getAgentDataSet().coBrowseData;i.authKey=h.acsResponse,i.coBrowseSessionInfo.agtAuthCode=h.acsResponse,i.coBrowseSessionInfo.cobrowseState=a.Services.Cobrowse.Common.CobrowseState.COBROWSEAGENTREADYTOCOBROWSESTATE,i.options=h.options,$.extend(c.getAgentDataSet().coBrowseData,i),a.Base.CobrowseCookie.set("AGENT_ACS_TOKEN",c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,null),c.openConnection(d)}else if(h&&h.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.REDIRECTSTATUSCODE&&e){e=!1,b.affinity=h.acsResponse;var j=c._agentCobrowse.createJoinSessionArguments();$.extend(j,b),c.getAgentDataSet().coBrowseData.redirectURL=h.acsResponse,$.extend(c.getAgentDataSet().coBrowseData.options,h.options),c._agentCobrowseProvider.joinSession(b).then(g,f)}else h&&h.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.FAILSTATUSCODE&&d.reject(new a.Base.CoBrowseError(h.errorCode,h.errorMessage,h.errorMessage))};return c._agentCobrowseProvider.joinSession(b).then(g,f),d.promise()},b.prototype.joinLiveSession=function(b){var c=this,d=$.Deferred(),e=!0,f=function(a){c.onFailure(a,d)},g=function(h){if(h&&h.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSSTATUSCODE&&h.acsResult===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSRESULT){var i=c.getAgentDataSet().coBrowseData;i.authKey=h.acsResponse,i.passPhrase=b.sessionkey,i.coBrowseSessionInfo.agtAuthCode=h.acsResponse,i.coBrowseSessionInfo.cobrowseState=a.Services.Cobrowse.Common.CobrowseState.COBROWSEINPROGRESSSTATE,i.coBrowseSessionInfo.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLFALSESTATE,i.coBrowseSessionInfo.passPhrase=b.sessionkey,i.coBrowseSessionInfo.agentName=b.name,i.options=h.options,$.extend(c.getAgentDataSet().coBrowseData,i),a.Base.CobrowseCookie.set("AGENT_ACS_TOKEN",c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,null),c.openConnection(),d.resolve(c.getAgentDataSet().coBrowseData.coBrowseSessionInfo)}else if(h&&h.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.REDIRECTSTATUSCODE&&e){e=!1,b.affinity=h.acsResponse;var j=c._agentCobrowse.createLiveJoinSessionArguments();$.extend(j,b),c.getAgentDataSet().coBrowseData.redirectURL=h.acsResponse,c._agentCobrowseProvider.joinLiveSession(b).then(g,f)}else h&&h.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.FAILSTATUSCODE&&d.reject(new a.Base.CoBrowseError(h.errorCode,h.errorMessage,h.errorMessage))};return c._agentCobrowseProvider.joinLiveSession(b).then(g,f),d.promise()},b.prototype.statusSession=function(b){var c=this;void 0===b&&(b=c._agentCobrowse.createStatusArguments()),b.acstoken=c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode;var d=c.getAgentDataSet().coBrowseData.redirectURL;if(d&&""!==d){b.affinity=d;var e=c._agentCobrowse.createStatusArguments();$.extend(e,b)}this._retryCount<=this._retryAttemps?(b.acstoken||(b.acstoken=a.Base.CobrowseCookie.get("AGENT_ACS_TOKEN")),this._agentCobrowseProvider.statusSession(b).then(function(d){if(c._connRetryTimer&&(a.Base.CobrowseLogger.warn("Connected to Server! Stop retrying...."),clearInterval(c._connRetryTimer),c._connRetryTimer=null,c._retryCount=0),d&&d.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSSTATUSCODE&&d.acsResult===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSRESULT){var e=c.getAgentDataSet().coBrowseData;$.extend(e.coBrowseSessionInfo,d.acsResponse),$.extend(e.options,d.options),$.extend(c.getAgentDataSet().coBrowseData,e),c.openConnection(),c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState!==a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE||c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.cobrowseState===a.Services.Cobrowse.Common.CobrowseState.COBROWSEPAUSEDSTATE?(c.updateOnCtrlChg(!0),c.stopInactiveTimer()):c.updateOnCtrlChg(!1),c.onStart()}else d&&d.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.REDIRECTSTATUSCODE&&!b.affinity?(b.affinity=d.acsResponse,c.getAgentDataSet().coBrowseData.redirectURL=d.acsResponse,c.statusSession(b)):d.errorCode===a.Services.Cobrowse.Common.CobrowseConstants.NOAGENTSESSIONFOUNDSTATUSCODE?(c.shutdown(),c.onFail({isDisconnected:!0,isAgentSessionNotFound:!0})):c.onFail({isDisconnected:!0,isAgentSessionNotFound:!0})},function(b){a.Base.CobrowseLogger.warn(" Status called failed "+b),c.onFail({isDisconnected:!1,isAgentSessionNotFound:!1})})):(a.Base.CobrowseLogger.warn("Maximum reconnect attempts exceeded "),clearInterval(c._connRetryTimer),c._connRetryTimer=null,c.onFail({isDisconnected:!0}),c.stopInactiveTimer(),c._retryCount=0,c.shutdown())},b.prototype.logoutSession=function(b){var c=this,d=$.Deferred();void 0===b&&(b=c._agentCobrowse.createLogoutSessionArguments()),b.acstoken=c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,b.eurl=c.getCurrentURL();var e=c.getAgentDataSet().coBrowseData.redirectURL;e&&""!==e&&(b.affinity=e);var f=function(b){c._connRetryTimer&&(a.Base.CobrowseLogger.warn("Logout !! Clear Connection Retry timer.."),clearInterval(c._connRetryTimer),c._connRetryTimer=null),b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSSTATUSCODE&&b.acsResult===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSRESULT?(d.resolve(c.getAgentDataSet().coBrowseData.coBrowseSessionInfo),c.shutdown(),c.getAgentDataSet().coBrowseData.redirectURL="",c.stopInactiveTimer()):b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.FAILSTATUSCODE&&d.reject(new a.Base.CoBrowseError(b.errorCode,b.errorMessage,b.errorMessage))},g=function(a){c.onFailure(a,d),c.getAgentDataSet().coBrowseData.redirectURL=""};return this._agentCobrowseProvider.logoutSession(b).then(f,g),d.promise()},b.prototype.openConnection=function(b){var c=this;if(!this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode)return void c.onFail({message:"Unable to open connection, token = "+c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode});this._agentCobrowseProvider.attachNetworkEvent(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_OPEN,function(d){a.Base.CobrowseLogger.info("openConnection::result"+d),c.rpcStartSession(b)}),c._agentCobrowseProvider.attachNetworkEvent(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_CLOSE,function(){c._connRetryTimer||(c._connRetryTimer=setInterval(function(){a.Base.CobrowseLogger.info("ConnectionClose:: retrying to connect again"),c.resetInactiveCounter(),c._retryCount++;var b=c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode;b||(b=a.Base.CobrowseCookie.get("AGENT_ACS_TOKEN")),c.shutdown(!1),a.Base.CobrowseCookie.set("AGENT_ACS_TOKEN",b,null),c.statusSession()},c._connRetryInterval))}),this.startSocketConnection()},b.prototype.onDemandUpdate=function(){$(this._iframeDivSelector).length>0&&$(this._iframeDivSelector).contents().find("body").removeClass("cbe-cursor-wait"),this.rpcSyncAction({event:"refresh",type:"null",id:"null",cssSelector:"null",value:"null"})},b.prototype.rpcStartSession=function(b){var c=this;c._agentCobrowseProvider.callJsonRPC("agentservice","startSession",c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,"",c.getCurrentURL(),function(d){b&&b.resolve(c.getAgentDataSet().coBrowseData.coBrowseSessionInfo),a.Base.CobrowseLogger.info("startSession:: Session established"+d),c.startOnConnection(),c.rpcOnConnection()},function(b){a.Base.CobrowseLogger.error("startSession:: Session not established"+b),c.onFail.call(c)})},b.prototype.rpcRequestControl=function(){var b=$.Deferred(),c=function(c){a.Base.CobrowseLogger.info("RequestControl:: sent"+c),this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLPENDINGSTATE,b.resolve(this.getAgentDataSet().coBrowseData.coBrowseSessionInfo)},d=function(c){b.reject(new a.Base.CoBrowseError(c.getErrorCode(),c.getReason(),c.getMessage()))};return this._agentCobrowseProvider.sendJsonRPC("agentservice","requestControl",[this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,this.getCurrentURL()]).then(c.bind(this),d),b.promise()},b.prototype.rpcReleaseControl=function(){var b=$.Deferred(),c=function(c){a.Base.CobrowseLogger.info("ReleaseControl:: sent"+c),this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLFALSESTATE,this.stopInactiveTimer(),this.updateOnCtrlChg(!0),this._agentCobrowseWindow._mPtr.show(),b.resolve(this.getAgentDataSet().coBrowseData.coBrowseSessionInfo)},d=function(b){a.Base.CobrowseLogger.error("releaseControl:: Unable to reach customer"+b.data)};return this._agentCobrowseProvider.sendJsonRPC("agentservice","releaseControl",[this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,this.getCurrentURL()]).then(c.bind(this),d),b.promise()},b.prototype.rpcSendChatMsg=function(){var b=this;b._agentCobrowseProvider.callJsonRPC("agentservice","sendChatMsg",b.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,b.getCurrentURL(),function(b){a.Base.CobrowseLogger.info("sendChatMsg:: sent"+b)},function(b){a.Base.CobrowseLogger.error("sendChatMsg:: Unable to reach customer"+b)})},b.prototype.rpcOnConnection=function(){this._agentCobrowseProvider.callJsonRPC("agentservice","onConnection",this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,"",function(b){a.Base.CobrowseLogger.info("onConnection:: onConnection send to customer: "+b)},function(b){a.Base.CobrowseLogger.warn("notifyCustomer:: Unable to send noftify Customer"+b)})},b.prototype.rpcGetNextUpdate=function(){this._agentCobrowseProvider.callJsonRPC("agentservice","getNextUpdate",this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,function(b){a.Base.CobrowseLogger.info("doGetNextUpdate:: sent"+b)},function(b){a.Base.CobrowseLogger.error("doGetNextUpdate:: Unable to reach customer"+b.data)})},b.prototype.rpcSyncAction=function(b){this._agentCobrowseProvider.callJsonRPC("agentservice","syncAction",this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,b,function(b){a.Base.CobrowseLogger.info("syncAction:: sent"+b)},function(b){a.Base.CobrowseLogger.error("syncAction:: Unable to reach customer"+b.data)})},b.prototype.rpcSendMousePos=function(a){this._agentCobrowseProvider.callJsonRPC("agentservice","sendMousePos",this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,a)},b.prototype.rpcSendScrollPos=function(a){this._agentCobrowseProvider.callJsonRPC("agentservice","sendScrollPos",this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,{event:"scroll",scrollTop:a.scrollTop,scrollLeft:a.scrollLeft,iframeSelector:a.iframeSelector})},b.prototype.rpcSendAgentAction=function(){this._agentCobrowseProvider.callJsonRPC("agentservice","sendAgentActionToACustomer",this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,actionObj,function(b){a.Base.CobrowseLogger.info("sendAgentAction:: sent"+b)},function(b){a.Base.CobrowseLogger.error("sendAgentAction:: Unable to reach customer"+b)})},b.prototype.rpcOnMouseSel=function(){if(this._isHighilightEnabled){var b=this.getTextRange(),c=this;c._agentCobrowseProvider.callJsonRPC("agentservice","onMouseSel",c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,{event:"mouseselect",mhighlightText:b,iframeSelector:this._iframeSelector},function(b){a.Base.CobrowseLogger.info("Mouse selected"+b),c.resetInactiveCounter()},function(b){a.Base.CobrowseLogger.warn("error while sending mouse select: "+b)})}},b.prototype.rpcUpdateIdleTime=function(b){var c=this,d=b+60*c.getAgentDataSet().coBrowseData.options["CB.INACTIVE_TIMEOUT"];c._agentCobrowseProvider.callJsonRPC("agentservice","inactiveTime",c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,d,c.getCurrentURL(),function(b){a.Base.CobrowseLogger.info("inactiveTime:: sent"+b)},function(b){a.Base.CobrowseLogger.error("inactiveTime:: Unable to update in audit log"+b)})},b.prototype.registerJsonRPCCallbacks=function(){this._agentCobrowseProvider.registerServerCallback("onMouseUpdate",this.onMouseUpdateCallBack,this),this._agentCobrowseProvider.registerServerCallback("onScrollUpdate",this.onScrollUpdateCallBack,this),this._agentCobrowseProvider.registerServerCallback("onViewUpdate",this.onViewUpdateCallBack,this),this._agentCobrowseProvider.registerServerCallback("onStateChange",this.onStateChangeCallBack,this),this._agentCobrowseProvider.registerServerCallback("onChatMsg",this.onChatMsgCallBack,this),this._agentCobrowseProvider.registerServerCallback("onSessionClosed",this.onSessionClosedCallBack,this),this._agentCobrowseProvider.registerServerCallback("onSessionTimeout",this.onSessionTimeoutCallBack,this),this._agentCobrowseProvider.registerServerCallback("onCustomerJoin",this.onCustomerJoinCallBack,this),this._agentCobrowseProvider.registerServerCallback("heartBeat",this.heartBeatCallBack,this),this._agentCobrowseProvider.registerServerCallback("onMouseSel",this.onMouseSelCallBack,this),this._agentCobrowseProvider.registerServerCallback("inactiveTime",this.inactiveTimeCallBack,this),this._agentCobrowseProvider.registerServerCallback("customerMovedAway",this.customerMovedAwayCallBack,this)},b.prototype.getCurrentURL=function(){return encodeURI(Base64.encode(window.location.href))},b.prototype.onStart=function(b){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_START,b)},b.prototype.onFail=function(b){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_FAIL,b)},b.prototype.onSessionClose=function(b){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_SESSION_CLOSE,b)},b.prototype.onSessionTimeout=function(){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_SESSION_TIMEOUT)},b.prototype.onControlGrant=function(){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CONTROL_GRANT)},b.prototype.onControlDenial=function(){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CONTROL_DENIAL)},b.prototype.onControlRevoke=function(){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CONTROL_REVOKE)},b.prototype.onCustomerJoin=function(){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTOMER_JOIN)},b.prototype.onViewUpdate=function(){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_VIEW_UPDATE)},b.prototype.onPause=function(){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_PAUSE)},b.prototype.onResume=function(){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_RESUME)},b.prototype.onCustomerDead=function(){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTOMER_DEAD)},b.prototype.onInActivityTimerOccured=function(b){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_INACTIVITY_TIMEOUT,b)},b.prototype.onStopInActivityTimerOccured=function(b){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_STOPINACTIVITY_TIMEOUT,b)},b.prototype.onFailure=function(b,c){var d=b.getMessage();a.Base.CobrowseLogger.error(b.getReason(),d),c.reject(new a.Base.CoBrowseError(b.getErrorCode(),b.getReason(),d))},a.Services.Cobrowse.Agent.AgentCobrowseService=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(){this._iframeDivID=void 0,this._iframeDivSelector=void 0,this._iframeDiv=void 0,this._iframe=void 0,this._iframeBody=void 0,this._isTitleEnable=!0,this._mYr=100,this._mYrOffset=0,this._mXr=100,this._mXrOffset=0,this._expectScrollUpdate=!1,this._mNodeCss=void 0,this._mElement=void 0,this._mNodeId=void 0,this._mNodeEvt=void 0,this._mNodeCssOld=void 0,this._mY=0,this._mYO=0,this._mX=0,this._mXO=0,this._mmSyncInterval=1e3,this._mmSyncTimer=void 0,this._inactiveCounter=120,this._inactiveInterval=5e3,this._inactivityMessage="",this._connRetryInterval=1e4,this._connRetryTimer=null,this._retryAttemps=10,this._retryCount=0,this._isHighilightEnabled=!0,this._agentCSSPath="css/",this._agentImagePath="img/",this._custScreenHeight=0,this._custScreenWidth=0,this._agentCobrowseWindow=void 0,this._workRequestId=null}a.Services.Cobrowse.Agent.AgentCobrowseServiceData=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a,b){"use strict";var c={startOnConnection:function(){this.registerJsonRPCCallbacks(),this._iframeDiv=b(this._iframeDivSelector)},handleEvtForNode:function(c,d){var e=this;try{if((this._mNodeCss!==c.getPath()||this._mNodeId!==c.attr("id")||this._mNodeEvt!==d)&&(this._mNodeCss=c.getPath(),this._mNodeId=c.attr("id"),this._mNodeEvt=d,c.is("li")||c.is("a")||c.is("div"))){var f=c.attr("type"),g=c.value,h={event:d,id:this._mNodeId,cssSelector:this._mNodeCss,type:f,value:g,iframeSelector:this._iframeSelector};e.rpcSyncAction(h),b(this._iframeDivSelector).length>0&&b(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait")}}catch(i){a.Base.CobrowseLogger.warn("handleEvtForNode: Failed "+i)}},onViewUpdateCallBack:function(b){this.onViewUpdate(),a.Base.CobrowseLogger.info("////////////////////////////// View Update received //////////////////////////////////////"),this.processViewUpdate(b),this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState!==a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE&&this.rpcGetNextUpdate()},onStateChangeCallBack:function(c){var d=this.getAgentDataSet().coBrowseData;switch(c){case"Pause":d.coBrowseSessionInfo.cobrowseState=a.Services.Cobrowse.Common.CobrowseState.COBROWSEPAUSEDSTATE,b.extend(this.getAgentDataSet().coBrowseData,d),this.onPause();break;case"resume":d.coBrowseSessionInfo.cobrowseState=a.Services.Cobrowse.Common.CobrowseState.COBROWSEINPROGRESSSTATE,b.extend(this.getAgentDataSet().coBrowseData,d),this.onResume();break;case"grant":d.coBrowseSessionInfo.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE,b.extend(this.getAgentDataSet().coBrowseData,d),this.onControlGrant(),this.updateOnCtrlChg(!1),this.startInactiveTimer();break;case"deny":d.coBrowseSessionInfo.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLFALSESTATE,b.extend(this.getAgentDataSet().coBrowseData,d),this.onControlDenial();break;case"revoke":this.onControlRevoke(),d.coBrowseSessionInfo.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLFALSESTATE,b.extend(this.getAgentDataSet().coBrowseData,d),this.updateOnCtrlChg(!0),this.stopInactiveTimer();break;default:a.Base.CobrowseLogger.error("onStateChange: Unknown State")}},onChatMsgCallBack:function(){},onSessionClosedCallBack:function(a){this.stopInactiveTimer(),this.shutdown(),this.onSessionClose({msg:a})},onSessionTimeoutCallBack:function(){this.onSessionTimeout()},onCustomerJoinCallBack:function(b){b?(a.Base.CobrowseLogger.info("onCustomerJoin: ["+b.customerName+","+b.cobrowseState+","+b.agentControlState+"]"),this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.cobrowseState=b.cobrowseState,this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.custAuthCode=b.custAuthCode,this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.custSessionTransferInProgress=b.custSessionTransferInProgress,this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.custUserAgent=b.custUserAgent,this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.customerName=b.customerName,this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState=b.agentControlState,this.onCustomerJoin()):a.Base.CobrowseLogger.error("onCustomerJoin: "+e[0])},heartBeatCallBack:function(){},inactiveTimeCallBack:function(){},customerMovedAwayCallBack:function(){this.onCustomerDead()},createCobrowseWindow:function(c,d){var e=b(c._pageDocument).find("iframe");e&&e.length>0&&b.each(e,function(e,f){var g=b(f).attr("cbid");b(this).contents().off("mousemove.cbiframeid"),b(this).contents().on("mousemove.cbiframeid",function(a){d._iframeSelector=g});var h=new a.Services.Cobrowse.Agent.AgentCobrowseWindow(b(f).contents(),d,g,f.contentWindow);d.createCobrowseWindow(h,d),c.addIframeWindow(h)})},getIframeSelectorId:function(a){return a._iframeSelector&&"main"===a._iframeSelector?"iframe":a._iframeSelector},processViewUpdate:function(c){var d=this,e=c.data,f=c.cssData,g=c.windowSize,h=c.scrollPosition,i=c.iframeSelector;if(0===b(this._iframeDivSelector).length)return void a.Base.CobrowseLogger.info("IFrame not found");if(i)if("main"===i)this._agentCobrowseWindow=new a.Services.Cobrowse.Agent.AgentCobrowseWindow(b(this._iframeDivSelector).contents(),this,i,b(this._iframeDivSelector)[0].contentWindow),b(this._iframeDivSelector).contents().off("mousemove.cbiframeid"),b(this._iframeDivSelector).contents().on("mousemove.cbiframeid",function(a){d._iframeSelector="main"}),f?this._agentCobrowseWindow.updateHead(f):a.Base.CobrowseLogger.info("No head section update!"),e?this._agentCobrowseWindow.updateBody(b(this._iframeDivSelector),e,g,h):a.Base.CobrowseLogger.warn("No Update Received from Customer! - Clearing the view"),this.createCobrowseWindow(this._agentCobrowseWindow,this);else{var j=this.getAgentCoBrowseWindow(i,this._agentCobrowseWindow);if(!j)return;j._iframes=[],j.updateHead(f),j.updateBody(b(this._iframeDivSelector),e,g,h),this.createCobrowseWindow(j,this)}},getAgentCoBrowseWindowRecursively:function(a,b){var c=null;if(a){if(b._iframeSelector===a)return b;var d;for(d=0;d<b._iframes.length&&!(c=this.getAgentCoBrowseWindowRecursively(a,b._iframes[d]));d++);}return c},getAgentCoBrowseWindow:function(a,b){return b||(b=this._agentCobrowseWindow),b=this.getAgentCoBrowseWindowRecursively(a,b),b||(b=this._agentCobrowseWindow),b},disableTabControl:function(b){9===b.keyCode&&(a.Base.CobrowseLogger.log("Event tab recieved, killing it"),b.preventDefault())},shutdown:function(c){var d=c;"boolean"!=typeof d&&(d=!0),this.getAgentDataSet().coBrowseData=new a.Base.CobrowseData,this.stopSocketConnection(),this._agentCobrowseWindow&&this.updateOnCtrlChg(!0),d&&(b(this._iframeDivSelector).length>0&&(b(this._iframeDivSelector).empty(),b(this._iframeDivSelector).contents().find("body").empty()),this._connRetryTimer&&(clearInterval(this._connRetryTimer),this._connRetryTimer=null),this._retryCount=0),this._mmSyncTimer&&(clearInterval(this._mmSyncTimer),this._mmSyncTimer=null),this.stopInactiveTimer(),a.Base.CobrowseCookie.erase("AGENT_ACS_TOKEN")},updateOnCtrlChg:function(a){a?(b(this._iframeDivSelector).length>0&&this._agentCobrowseWindow.call(this._agentCobrowseWindow.maskWindows,[],this._agentCobrowseWindow),this.enableMouseSync(!1),this._agentCobrowseWindow.call(this._agentCobrowseWindow.stopTracker,[],this._agentCobrowseWindow)):(this._agentCobrowseWindow.call(this._agentCobrowseWindow.removeElementsAndStartTracker,[],this._agentCobrowseWindow),this.enableMouseSync(!0))},startInactiveTimer:function(){this.resetInactiveCounter(),a.Base.CobrowseLogger.info("START INACTIVE TIMER START FOR AGENT "),null!==this._inactiveTimer&&clearInterval(this._inactiveTimer);var b=this;this._inactiveTimer=setInterval(function(){b.incInactiveCounter(),b._inactiveCounter>60*b.getAgentDataSet().coBrowseData.options["CB.INACTIVE_TIMEOUT"]&&(b.onInActivityTimerOccured(b.getAgentDataSet().coBrowseData.options["CB.INACTIVE_TIMEOUT_MESSAGE"]),a.Base.CobrowseLogger.info("fire _onCobrowseRequestSuccessCallbacks "),b.resetInactiveCounter())},b._inactiveInterval)},stopInactiveTimer:function(){a.Base.CobrowseLogger.info(" STOP INACTIVE TIMER ");var b=this;null!==b._inactiveTimer&&(clearInterval(b._inactiveTimer),b.onStopInActivityTimerOccured(b.getAgentDataSet().coBrowseData.options["CB.STOP_INACTIVE_TIMEOUT_MESSAGE"])),b.resetInactiveCounter()},resetInactiveCounter:function(){this._inactiveCounter=0,a.Base.CobrowseLogger.info("RESET COUNTER  "+this._inactiveCounter)},incInactiveCounter:function(){a.Base.CobrowseLogger.info("Increment Inactive Counter "+this._inactiveCounter),this._inactiveCounter=this._inactiveCounter+5}};b.extend(a.Services.Cobrowse.Agent.AgentCobrowseService.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a){"use strict";function b(b,c,d,e){this._pageDocument=b,this._agentCobrowseUtilityService=c,this._iframes=[],this._iframeSelector=d,this._cbWindow=e,a.Services.Cobrowse.Agent.AgentCobrowsePageData.apply(this)}b.prototype.call=function(a,b,c){a.apply(c,b),this._iframes.length>0&&$.each(this._iframes,function(c,d){this.call(a,b,d)})},b.prototype.addIframeWindow=function(a){this._iframes.push(a)},b.prototype.updateHead=function(a){var b=$('<link id="cbeCSS" type="text/css" rel="stylesheet" href="'+this._agentCobrowseUtilityService._agentCSSPath+'/agent.css"/>');a&&($(this._pageDocument).find("head").empty(),$(this._cbWindow.document.head).html(Base64.decode(a)),$(this._pageDocument).find("head").append(b),"main"===this._iframeSelector&&$(this._pageDocument).find("meta[name='cssHover']").attr("content")&&(this._agentCobrowseUtilityService._hoverCollection=JSON.parse($(this._pageDocument).find("meta[name='cssHover']").attr("content"))))},b.prototype.updateBody=function(b,c,d,e){if($(this._pageDocument).find("body").empty(),$(this._cbWindow.document.body).html(Base64.decode(c)),$(this._pageDocument).find("textarea").each(function(){try{var a=$(this).attr("scrollTop");$(this).scrollTop(a)}catch(b){}}),$(this._pageDocument).find("div[scrollTop]").each(function(){try{var a=$(this).attr("scrollTop");$(this).animate({scrollTop:a})}catch(b){}}),$(this._pageDocument).find("body").append(this.getPtr()),$(this._pageDocument).find("body").append(this.getReadOnlyMask()),$(this._pageDocument).find("body").append(this.getTitleNode()),this._agentCobrowseUtilityService.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState===a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE?(this._mPtr.hide(),this._mask.hide(),this._titleNode.hide(),this.startTracker(),$(this._pageDocument).find("body").removeClass("cbe-cursor-wait")):(this.setMousePoistionRecusrsively(this._agentCobrowseUtilityService._agentCobrowseWindow),this._mPtr.show(),this._mask.show(),$(this._pageDocument).find("body").removeClass("cbe-cursor-wait").removeClass("cbe-cursor-allowed").addClass("cbe-cursor-not-allowed")),d){var f=JSON.parse(d);if("main"===this._iframeSelector&&(this._custScreenWidth=f.w,this._custScreenHeight=f.h,$(b).css({width:f.w}),$(b).css({height:f.h}),this._mask.css({width:$(this._pageDocument).width()}),this._mask.css({height:$(this._pageDocument).height()}),this._custScreenWidth!==f.w||this._custScreenHeight!==f.h)){var g={height:f.h,width:f.w};this._agentCobrowseUtilityService.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTSCREEN_RESIZE,g)}}if(e){var h=JSON.parse(e);if(this._scrollTopOld=h.scrollY,this._scrollLeftOld=h.scrollX,h.scrollY!==this._scrollTopOld||h.scrollX!==this._scrollLeftOld){var i={scrollLeft:h.scrollX,scrollTop:h.scrollY};this._agentCobrowseUtilityService.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTSCREEN_SCROLL_CHANGE,i)}}a.Base.CobrowseLogger.info("View Update Complete: "+new Date),this._agentCobrowseUtilityService.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState!==a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE&&($(this._pageDocument).find("body").find("input").bind("keydown",this.disableTabControl),$(this._pageDocument).find("body").find("a").bind("keydown",this.disableTabControl))},b.prototype.startTracker=function(){var b=this._agentCobrowseUtilityService,c=b._hoverCollection,d=this;a.Base.CobrowseLogger.info("_startTracker: begin");var e=$(this._pageDocument).find("body");$(e).contents().on({mouseup:function(){return b.rpcOnMouseSel(),!1}}),$(this._pageDocument).find("a").click(function(a){var c=$(this).attr("id"),d=$(this).attr("type"),e=$(this).getPath(),f=$(this).attr("href");return a.stopPropagation(),a.preventDefault(),b.rpcSyncAction({event:"click",type:d,id:c,cssSelector:e,value:f,iframeSelector:b._iframeSelector}),$(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1}),c&&c.psuedo&&$.each(c.psuedo,function(a,c){$(d._pageDocument).find(c.hoverOn).mouseenter(function(a){var c=$(this).attr("id"),d=$(this).attr("type"),e=$(this).getPath();return a.stopPropagation(),a.preventDefault(),b.rpcSyncAction({event:"hoverin",type:d,id:c,cssSelector:e,iframeSelector:b._iframeSelector}),!1}).mouseleave(function(a){var c=$(this).attr("id"),d=$(this).attr("type"),e=$(this).getPath();return a.stopPropagation(),a.preventDefault(),b.rpcSyncAction({event:"hoverout",type:d,id:c,cssSelector:e,iframeSelector:b._iframeSelector}),!1})}),$(this._pageDocument).find("button").click(function(a){var c=$(this).attr("id"),d=$(this).attr("type"),e=$(this).getPath(),f=$(this).prop("textContent");a.preventDefault(),a.stopPropagation();var g={event:"click",type:d,id:c,cssSelector:e,value:f,iframeSelector:b._iframeSelector};return b.rpcSyncAction(g),$(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1}),$(this._pageDocument).find("input").click(function(a){var c,d,e,f=$(this).attr("id"),g=$(this).attr("type");return"submit"===g?(c=$(this).getPath(),a.preventDefault(),a.stopPropagation(),d=$(this).val(),e={event:"click",type:g,id:f,cssSelector:c,value:d,iframeSelector:b._iframeSelector},b.rpcSyncAction(e),$(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1):"button"===g?(c=$(this).getPath(),a.preventDefault(),a.stopPropagation(),d=$(this).val(),e={event:"click",type:g,id:f,cssSelector:c,value:d,iframeSelector:b._iframeSelector},b.rpcSyncAction(e),$(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1):void 0}),$(this._pageDocument).find(":checkbox").click(function(a){var c=$(this).attr("id"),d=$(this).attr("type"),e=$(this).getPath(),f=$(this).prop("checked");a.stopPropagation(),a.preventDefault();var g={event:"click",type:d,id:c,cssSelector:e,value:f,iframeSelector:b._iframeSelector};return b.rpcSyncAction(g),$(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1}),$(this._pageDocument).find(":radio").click(function(){var a=$(this).attr("id"),c=$(this).attr("type"),d=$(this).getPath(),e=$(this).prop("checked"),f={event:"click",type:c,id:a,cssSelector:d,value:e,iframeSelector:b._iframeSelector};return b.rpcSyncAction(f),!1}),$(this._pageDocument).find("label").click(function(a){var c=$(this).attr("id"),d=$(this).attr("type"),e=$(this).getPath(),f=$(this).text();a.stopPropagation(),a.preventDefault();var g={event:"click",type:d,id:c,cssSelector:e,value:f,iframeSelector:b._iframeSelector};return b.rpcSyncAction(g),$(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1}),$(this._pageDocument).find("span").click(function(a){
var c=$(this).attr("id"),d=$(this).attr("type"),e=$(this).getPath();a.stopPropagation(),a.preventDefault();var f={event:"click",type:d,id:c,cssSelector:e,iframeSelector:b._iframeSelector};return b.rpcSyncAction(f),$(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1}),$(this._pageDocument).find("li").click(function(a){var c=$(this).attr("id"),d=$(this).attr("type"),e=$(this).getPath(),f=$(this).find("option:selected").text();a.stopPropagation(),a.preventDefault();var g={event:"click",type:d,id:c,cssSelector:e,value:f,index:this.selectedIndex,iframeSelector:b._iframeSelector};return b.rpcSyncAction(g),$(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1}),$(this._pageDocument).find("select").change(function(a){var c=$(this).attr("id"),d=$(this).attr("type"),e=$(this).getPath(),f=$(this).find("option:selected").text();a.stopPropagation(),a.preventDefault();var g={event:"change",type:d,id:c,cssSelector:e,value:f,index:this.selectedIndex,iframeSelector:b._iframeSelector};return b.rpcSyncAction(g),!1}),$(this._pageDocument).find("input").change(function(a){var c=$(this).attr("id"),d=$(this).attr("type");if("text"===d){var e=$(this).getPath(),f=$(this).val();a.stopPropagation(),a.preventDefault();var g={event:"change",type:d,id:c,cssSelector:e,value:f,iframeSelector:b._iframeSelector};return b.rpcSyncAction(g),$(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1}}),$(this._pageDocument).find("input").blur(function(a){var c=$(this).attr("id"),d=$(this).attr("type");if("text"===d){var e=$(this).getPath(),f=$(this).val();a.stopPropagation(),a.preventDefault();var g={event:"blur",type:d,id:c,cssSelector:e,value:f,iframeSelector:b._iframeSelector};return b.rpcSyncAction(g),$(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1}}),$(this._pageDocument).find("input").keyup(function(a){var c=$(this).attr("id"),d=$(this).getPath(),e=$(this).attr("type"),f=this.value,g=null;"text"===e&&13===a.keyCode?(g={event:"keyup",id:c,cssSelector:d,type:e,value:f,index:"13",iframeSelector:b._iframeSelector},$(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait")):g={event:"keyup",id:c,cssSelector:d,type:e,value:f,iframeSelector:b._iframeSelector},b.rpcSyncAction(g)}),$(this._pageDocument).find("input").focusin(function(a){var c=$(this).attr("id"),d=$(this).getPath(),e=$(this).attr("type"),f=this.value,g=null;if("text"===e)return g={event:"focusin",id:c,cssSelector:d,type:e,value:f,iframeSelector:b._iframeSelector},$(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),void b.rpcSyncAction(g)}),$(this._pageDocument).find("textarea").keyup(function(){var a=$(this).attr("id"),c=$(this).getPath(),d=$(this).attr("type"),e=this.value,f=$(this).scrollTop(),g={event:"keyup",id:a,cssSelector:c,type:d,value:e,scrollTop:f,iframeSelector:b._iframeSelector};b.rpcSyncAction(g)}),$(this._pageDocument).find("textarea").scroll(function(){var a=$(this).attr("id"),c=$(this).getPath(),d=$(this).attr("type"),e=this.value,f=$(this).scrollTop(),g={event:"keyup",id:a,cssSelector:c,type:d,value:e,scrollTop:f,iframeSelector:b._iframeSelector};b.rpcSyncAction(g)}),$(this._pageDocument).find("div").scroll(function(){var a=$(this).attr("id"),c=$(this).getPath(),d=$(this).attr("type"),e=$(this).scrollTop(),f={event:"divscroll",id:a,cssSelector:c,type:d,value:"",scrollTop:e,iframeSelector:b._iframeSelector};b.rpcSyncAction(f)}),$(this._pageDocument).find("div.current").click(function(a){var c=$(this).attr("id"),d=$(this).attr("type"),e=$(this).getPath();a.stopPropagation(),a.preventDefault();var f={event:"click",type:d,id:c,cssSelector:e,value:this.selectedIndex,iframeSelector:b._iframeSelector};return b.rpcSyncAction(f),$(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1}),$(this._pageDocument).find("a, input, textarea, select, option, optgroup, button, fieldset, legend, img, area, map, object,ul > li ,nav > li, nav > li > div").each(function(){$(this).focusin(function(){b.handleEvtForNode($(this),"focusin")}),$(this).mouseenter(function(){b.handleEvtForNode($(this),"mouseenter")}),$(this).mouseleave(function(){b.handleEvtForNode($(this),"mouseleave")})})},b.prototype.stopTracker=function(){a.Base.CobrowseLogger.info("_stopTracker ..."),this._pageDocument.unbind(),this._pageDocument.off()},b.prototype.getPtr=function(){return this._mPtr=$('<div id="cbePtr" class="cbe-remote-cursor"></div>').css({top:this._agentCobrowseUtilityService._mYr,left:this._agentCobrowseUtilityService._mXr}),this._mPtr.css("backgroundImage","url('"+this._agentCobrowseUtilityService._agentImagePath+"/pointer.png')"),this._mPtr},b.prototype.getTitleNode=function(){return this._titleNode=$('<div class="cbtooltip"></div>'),this._titleNode},b.prototype.getReadOnlyMask=function(){return this._mask=$('<div id="cbeMask" class="cbe-readonly-mask"></div>'),this._mask},b.prototype.setMousePoistionRecusrsively=function(b){try{b._mPtr&&b._mPtr.hide();for(var c=0;c<b._iframes.length;c++)b._iframes[c]._mPtr&&b._iframes[c]._mPtr.hide(),this.setMousePoistionRecusrsively(b._iframes[c])}catch(d){a.Base.CobrowseLogger.error("Exception in setMousePoistionRecusrsively: "+d)}},b.prototype.doScrollSync=function(){var a=null,b=null;if($(this._cbWindow)&&(a=$(this._cbWindow).scrollLeft(),b=$(this._cbWindow).scrollTop()),b!==this._scrollTopOld||a!==this._scrollLeftOld){this._scrollLeftOld=a,this._scrollTopOld=b;var c={scrollTop:b,scrollLeft:a,iframeSelector:this._iframeSelector};this._agentCobrowseUtilityService.rpcSendScrollPos(c)}},b.prototype.setMousePositionOnUpdate=function(a,b){this.setMousePoistionRecusrsively(this._agentCobrowseUtilityService._agentCobrowseWindow),this._mPtr.show(),this._mPtr.css({top:b,left:a})},b.prototype.setTitleNodeOnUpdate=function(a,b){b&&a?(this._titleNode.empty(),this._titleNode.append(b),this._titleNode.css({top:this._agentCobrowseUtilityService._mYr+this._mPtr.height(),left:this._agentCobrowseUtilityService._mXr+this._mPtr.width()}),this._titleNode.show()):this._titleNode.hide()},b.prototype.removeCustomElements=function(){this._mPtr.remove(),this._mask.remove(),this._titleNode.remove()},b.prototype.unbindTab=function(){$(this._pageDocument).find("body").removeClass("cbe-cursor-not-allowed").addClass("cbe-cursor-allowed"),$(this._pageDocument).find("body").find("input").unbind("keydown",this.disableTabControl),$(this._pageDocument).find("body").find("a").unbind("keydown",this.disableTabControl)},b.prototype.removeElementsAndStartTracker=function(){this.removeCustomElements(),this.unbindTab(),this.startTracker()},b.prototype.removeLocalNodeRecursively=function(a){for(var b=0;b<a._iframes.length;b++)a._iframes[b].removeLocalNode(),this.removeLocalNodeRecursively(a._iframes[b])},b.prototype.onMouseUpdate=function(b){if(null!==b||void 0!==b){var c;c=$(this._pageDocument).find("body").find(b.cssSelector).get(0),c&&$(c).length>0&&(this.removeLocalNode(),this._agentCobrowseUtilityService._agentCobrowseWindow.removeLocalNode(),this.removeLocalNodeRecursively(this._agentCobrowseUtilityService._agentCobrowseWindow),$(this._pageDocument).find("body").append(this.highlight(c)));var d,e,f,g;if(b&&b.nodeCSSSelector&&"undefined"!==b.nodeCSSSelector)try{d=$(this._pageDocument).find("body").find(b.nodeCSSSelector).get(0);var h=b.nodeCSSSelector,i=["html","body"];!d&&h&&$.each(i,function(a,b){!d&&h.startsWith(b)&&h.length>h.indexOf(">")+1&&(h=h.substring(h.indexOf(">")+1),d=$(this._pageDocument).find("body").find(h).get(0))})}catch(l){a.Base.CobrowseLogger.error("Exception in finding mouse node: "+l)}if(d){var j=$(d).offset();j&&(e=parseInt(j.left)+$(d).width()*parseFloat(b.nodeX),f=parseInt(j.top)+$(d).height()*parseFloat(b.nodeY)),$(d).attr("title")?g=$(d).attr("title"):$(d).parents("[title]")[0]&&(g=$($(d).parents("[title]")[0]).attr("title"))}else e=b.mX,f=b.mY;if((e!==this._agentCobrowseUtilityService._mXr||f!==this._agentCobrowseUtilityService._mYr)&&(this._agentCobrowseUtilityService._mXr=e,this._agentCobrowseUtilityService._mYr=f,e+="px",f+="px",this.setMousePositionOnUpdate(e,f),this.setTitleNodeOnUpdate(this._agentCobrowseUtilityService._isTitleEnable,g),"main"===this._iframeSelector)){var k={left:this._agentCobrowseUtilityService._mXr,top:this._agentCobrowseUtilityService._mYr};this._agentCobrowseUtilityService.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUST_MOUSE_UPDATE,k)}}},b.prototype.onScrollUpdate=function(b){if(b&&(b.scrollTop!==this._scrollTopOld||b.scrollLeft!==this._scrollLeftOld)){this._scrollTopOld=b.scrollTop,this._scrollLeftOld=b.scrollLeft,navigator.userAgent.match(/(iPod|iPhone|iPad)/)?this._cbWindow.scrollTo(b.scrollLeft,b.scrollTop):this._cbWindow&&this._cbWindow.scrollTo(b.scrollLeft,b.scrollTop);var c={scrollLeft:b.scrollLeft,scrollTop:b.scrollTop};this._agentCobrowseUtilityService.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTSCREEN_SCROLL_CHANGE,c)}},b.prototype.maskWindows=function(){$(this._pageDocument).find("body").append(this.getReadOnlyMask().show()),$(this._pageDocument).find("body").removeClass("cbe-cursor-wait").removeClass("cbe-cursor-allowed").addClass("cbe-cursor-not-allowed")},b.prototype.highlight=function(b){var c="cbe-highlight";$(b).is("img")&&(c="cbe-highlight-img");try{this._mLocalNode=$('<div id="cbeHighlightId"></div>').addClass(c).css({top:$(b).offset().top-4+"px",left:$(b).offset().left-4+"px",width:$(b).outerWidth()+6+"px",height:$(b).outerHeight()+6+"px"})}catch(d){a.Base.CobrowseLogger.warn("Exception in highlight: "+d)}return this._mLocalNode},b.prototype.removeLocalNode=function(){this._mLocalNode&&(this._mLocalNode.remove(),a.Base.CobrowseLogger.info("enableMouseSync: removing highlight"))},b.prototype.bindEvent=function(a,b){$(this._pageDocument).bind(a,b)},b.prototype.unbindEvent=function(a){$(this._pageDocument).unbind(a)},a.Services.Cobrowse.Agent.AgentCobrowseWindow=b}(AvayaCoBrowseClientServices),function(a,b){"use strict";function c(b){this._cobrowseConfig=b,this._agentCobrowseService=new a.Services.Cobrowse.Agent.AgentCobrowseService(this),this._coBrowseCapability=new a.Base.CoBrowseCapability(a.Base.CobrowseCapabilityDenialReason.CAPABILITY_INVALID_STATE)}c.prototype={start:function(){if(!this._cobrowseConfig){var c=b.Deferred();return c.reject("Cobrowse configuration is not defined."),c.promise()}return this._agentCobrowseService.start(this._cobrowseConfig).then(function(b){return this._coBrowseCapability._updateIfChanged(!0,a.Base.CobrowseCapabilityDenialReason.CAPABILITY_NOT_DENIED),a.Base.CobrowseLogger.info("Successfully initialized cobrowse service"),b}.bind(this),function(b){a.Base.CobrowseLogger.error(b)})},getAgentData:function(){return this._agentCobrowseService.getAgentDataSet()&&this._agentCobrowseService.getAgentDataSet().coBrowseData?this._agentCobrowseService.getAgentDataSet().coBrowseData.coBrowseSessionInfo:new a.Base.CobrowseSessionInfo},setWorkRequestId:function(a){return this._agentCobrowseService.setWorkRequestId(a)},requestSession:function(a,b,c){return this._agentCobrowseService.requestSession({name:a,locale:b,emailid:c})},joinSession:function(a){return this._agentCobrowseService.joinSession({acstoken:a})},joinLiveSession:function(a,b,c){return this._agentCobrowseService.joinLiveSession({name:a,sessionkey:b,emailid:c})},logoutSession:function(a){return this._agentCobrowseService.logoutSession({reason:a})},requestControl:function(){return this._agentCobrowseService.rpcRequestControl()},onDemandUpdate:function(){return this._agentCobrowseService.onDemandUpdate()},releaseControl:function(){return this._agentCobrowseService.rpcReleaseControl()},updateIdleTime:function(a){this._agentCobrowseService.rpcUpdateIdleTime(a)},setIFrame:function(a){this._agentCobrowseService.setIFrame(a)},enableHighlight:function(){this._agentCobrowseService.enableHighlight(!0)},disableHighlight:function(){this._agentCobrowseService.enableHighlight(!1)},enableTitle:function(){this._agentCobrowseService.enableTitle(!0)},disableTitle:function(){this._agentCobrowseService.enableTitle(!1)},setAgentCSSPath:function(a){this._agentCobrowseService.setAgentCSSPath(a)},setAgentImagePath:function(a){this._agentCobrowseService.setAgentImagePath(a)},setAgentConnectionRetryAttempts:function(a){this._agentCobrowseService.setRetryAttempts(a)},setAgentConnectionRetryInterval:function(a){this._agentCobrowseService.setConnectionRetryInterval(a)},setMouseAndScrollSyncInterval:function(a){this._agentCobrowseService.setMouseAndScrollSyncInterval(a)}},a.Services.Cobrowse.Agent.AgentCobrowse=c}(AvayaCoBrowseClientServices,jQuery),function(a){"use strict";var b={EVENT_ON_ONREADY:"cbprovider.onReady",EVENT_ON_START:"cbprovider.onStart",EVENT_ON_FAIL:"cbprovider.onFail",EVENT_ON_JOINLIVESESSIONFAIL:"cbprovider.onJoinLiveSessionFail",EVENT_ON_JOINLIVESESSIONSUCCESS:"cbprovider.onJoinLiveSessionSuccess",EVENT_ON_SESSION_CLOSE:"cbprovider.onSessionClose",EVENT_ON_SESSION_TIMEOUT:"cbprovider.onSessionTimeout",EVENT_ON_CONTROL_GRANT:"cbprovider.onControlGrant",EVENT_ON_CONTROL_DENIAL:"cbprovider.onControlDenial",EVENT_ON_CONTROL_REVOKE:"cbprovider.onControlRevoke",EVENT_ON_CUSTOMER_JOIN:"cbprovider.onCustomerJoin",EVENT_ON_PAUSE:"cbprovider.onPause",EVENT_ON_RESUME:"cbprovider.onResume",EVENT_ON_CUSTOMER_DEAD:"cbprovider.onCustomerDead",EVENT_ON_INACTIVITY_TIMEOUT:"cbprovider.onInactivityTimeout",EVENT_ON_STOPINACTIVITY_TIMEOUT:"cbprovider.onStopInactivityTimeout",EVENT_ON_CUSTSCREEN_RESIZE:"cbprovider.onCustScreenResize",EVENT_ON_CUSTSCREEN_SCROLL_CHANGE:"cbprovider.onCustScreenScrollChange",EVENT_ON_CUST_MOUSE_UPDATE:"cbprovider.onCustMouseUpdate"};a.Services.Cobrowse.Agent.ObservableAgentEvents=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";var b={LANGUAGE_ENGLISH:"en_US",LANGUAGE_DEUTSCH:"de",LANGUAGE_FRENCH:"fr",LANGUAGE_CHINESE:"zh_CN",LANGUAGE_SPANISH:"es",LANGUAGE_ITALIAN:"it",LANGUAGE_JAPANESE:"ja",LANGUAGE_KOREAN:"ko",LANGUAGE_PORTUGUESE:"pt_BR",LANGUAGE_RUSSIAN:"ru"};a.Services.Cobrowse.LocaleField=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";var b={UNKNOWN_REASON:"UNKNOWN_REASON",INTERNAL_ERROR:"INTERNAL_ERROR",RETRY:"RETRY",SERVER_UNAVAILABLE:"SERVER_UNAVAILABLE",INVALID_SERVER_RESPONSE:"INVALID_SERVER_RESPONSE",AUTHENTICATION_FAILED:"AUTHENTICATION_FAILED",REQUEST_TIMEOUT:"REQUEST_TIMEOUT",REQUEST_CANCELED:"REQUEST_CANCELED",COBROWSE_URL_NOT_FOUND:"COBROWSE_URL_NOT_FOUND"};a.Services.Cobrowse.Common.CobrowseErrorReason=b}(AvayaCoBrowseClientServices),function(a){"use strict";var b={AGENTCONTROLTRUESTATE:"true",AGENTCONTROLFALSESTATE:"false",AGENTCONTROLPENDINGSTATE:"pending",AGENTCONTROLEXPIREDSTATE:"expired"};a.Services.Cobrowse.Common.AgentControlState=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";var b={COBROWSEAGENTREADYTOCOBROWSESTATE:"Waiting for Customer",COBROWSECUSTOMERREADYTOCOBROWSESTATE:"Waiting for Agent",COBROWSEINPROGRESSSTATE:"InProgress",COBROWSEIDLESTATE:"Idle",COBROWSEAWAYSTATE:"Away",COBROWSEPAUSEDSTATE:"Paused"};a.Services.Cobrowse.Common.CobrowseState=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";var b={SUCCESSSTATUSCODE:"200",FAILSTATUSCODE:"500",REDIRECTSTATUSCODE:"302",NOSESSIONFOUNDSTATUSCODE:"1002",NOAGENTSESSIONFOUNDSTATUSCODE:"1001",SUCCESSRESULT:"success",CUSTOMERSERVICE:"customerservice",ONGETNEXTUPDATE:"onGetNextUpdate",ONCONTROLREQUEST:"onControlRequest",ONCONTROLRELEASE:"onControlRelease",ONREMOTEACTION:"onRemoteAction",ONSESSIONCLOSED:"onSessionClosed",ONMOUSEUPDATE:"onMouseUpdate",ONSCROLLUPDATE:"onScrollUpdate",ONAGENTJOIN:"onAgentJoin",ONMOUSESEL:"onMouseSel",INACTIVETIME:"inactiveTime",AGENTMOVEDAWAY:"agentMovedAway",AGENTONMOUSEUPDATE:"onMouseUpdate",AGENTONSCROLLUPDATE:"onScrollUpdate",AGENTONVIEWUPDATE:"onViewUpdate",AGENTONSTATECHANGE:"onStateChange",AGENTONCHATMSG:"onChatMsg",AGENTONSESSIONCLOSED:"onSessionClosed",AGENTONSESSIONTIMEOUT:"onSessionTimeout",AGENTONCUSTOMERJOIN:"onCustomerJoin",AGENTHEARTBEAT:"heartBeat",AGENTONMOUSESEL:"onMouseSel",AGENTINACTIVETIME:"inactiveTime",AGENTCUSTOMERMOVEDAWAY:"customerMovedAway"};a.Services.Cobrowse.Common.CobrowseConstants=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a,b){"use strict";function c(a,b){this._customerCobrowseWindow=a,this._coBrowseUtility=a._customerCobrowseService,this._coBrowseHtmlData=b,this._html5tags=["nav","header","footer","abbr","article","aside","audio","canvas","command","datalist","details","figure","figcaption","hgroup","keygen","mark","meter","output","progress","section","source","summary","time","video"],this._enableDataMasking=!0}c.prototype={_createInputField:function(){this._coBrowseHtmlData.find("input").each(function(){try{var a=b(this).attr("type");if("checkbox"===a)b(this).attr("checked",this.checked);else if("radio"===a){var c=b(b(this).getCPath()).is(":checked");c?b(this).attr("checked",!0):b(this).attr("checked",!1)}else b(this).attr("value",b(this).val())}catch(d){}})},_createSelectBox:function(){this._coBrowseHtmlData.find("select").each(function(){try{b(this).children().get(b(b(this).getCPath()).get(0).selectedIndex).setAttribute("selected",!0)}catch(a){}})},_createTextArea:function(){this._coBrowseHtmlData.find("textarea").each(function(){try{var a=b(b(this).getCPath()).val();a||(a=b(this).val()),b(this).html(a),b(this).attr("scrollTop",b(b(this).getCPath()).scrollTop())}catch(c){}})},_createDiv:function(){this._coBrowseHtmlData.find("div").each(function(){try{b(this).attr("scrollTop",b(b(this).getCPath()).scrollTop())}catch(a){}})},_createDataMaskingFields:function(){this._enableDataMasking&&(this._coBrowseHtmlData.find(".avcobrowse-mask").each(function(){try{b(this).val().length>0?(b(this).attr("value","*********"),b(this).is("textarea")&&b(this).html("*********")):b(this).attr("value",""),b(this).attr("disabled","disabled").addClass("cbe-mask-text").attr("title","You are not allowed to view or modify this.")}catch(a){}}),this._coBrowseHtmlData.find(".avcobrowse-block").each(function(){try{b(this).attr("disabled","disabled"),b(this).attr("title","You are not allowed to perform any action on this element"),b(this).is("button")?b(this).addClass("cbe-block-btn"):b(this).is("input")&&"checkbox"===this.type&&b(this).addClass("cbe-block-chkbox")}catch(a){}}))},_createImages:function(){var c=this;this._coBrowseHtmlData.find("img").each(function(){try{var d,e=b(this).attr("src");e&&-1===e.indexOf("data:image")?0===e.indexOf("//")?(d=window.location.protocol+e,b(this).attr("src",d)):0===e.indexOf("/")?(d=c._coBrowseUtility.getDomainURL()+e,b(this).attr("src",d)):0!==e.indexOf("http")&&(d=c._coBrowseUtility.getBaseURL()+e,b(this).attr("src",d)):a.Base.CobrowseLogger.info("WARNING: Check src attribute for <img> tag or img contains the src")}catch(f){}})},_createLinks:function(){var a=this;this._coBrowseHtmlData.find("link").each(function(){try{var c,d=b(this).attr("href"),e=b(this).attr("rel");"stylesheet"===e?d&&(0===d.indexOf("//")?(c=window.location.protocol+d,b(this).attr("href",c)):0===d.indexOf("/")?(c=a._coBrowseUtility.getDomainURL()+d,b(this).attr("href",c)):0===d.indexOf("http")&&0===d.indexOf("https")||(c=a._coBrowseUtility.getBaseURL()+d,b(this).attr("href",c))):b(this).remove()}catch(f){}})},_createIframe:function(){var a=this;this._coBrowseHtmlData.find("iframe").each(function(c,d){try{this.src&&b(this).removeAttr("src");var e=a._coBrowseUtility.getIframeSelectorId(a._customerCobrowseWindow)+c;b(this).attr("cbid",e)}catch(f){}})},_doRemoveKnownHTML:function(){this._coBrowseHtmlData.find("#cbeMask").remove(),this._coBrowseHtmlData.find("#cbePtr").remove(),this._coBrowseHtmlData.find("#cbtooltip").remove(),this._coBrowseHtmlData.find("#cbeHighlightId").remove(),this._coBrowseHtmlData.find(".cbe-mask-help").remove(),this._coBrowseHtmlData.find(".cbe-block-help").remove(),this._coBrowseHtmlData.find(".avcobrowse-hide").remove()},_doRemoveUnwantedHTML:function(){var c=this;b.each(c._coBrowseUtility._removeElementList,function(b,d){a.Base.CobrowseLogger.info("Removing element=>"+b+":"+d),c._coBrowseHtmlData.find("#"+d).remove()})},_doRemoveScript:function(){this._coBrowseHtmlData.find("script").remove()},_doCreateHtml5Tag:function(){if(-1!==navigator.appName.indexOf("Internet Explorer")&&-1!==navigator.appVersion.indexOf("MSIE 8"))for(var b=0;b<this._html5tags.length;b++)try{this._coBrowseHtmlData.find(this._html5tags[b]).replaceWith(this._changeHtml5Tag(this._html5tags[b]))}catch(c){a.Base.CobrowseLogger.error("Exception in cloning HTML5 tags in IE8 at the tag "+b+" "+c)}},_changeHtml5Tag:function(a){var c=a,d="";b.each(c.attributes,function(a,b){var c=b.name,e=b.value;d=" "+c+'="'+e+'"'});var e="<"+b(c).prop("tagName")+d+">"+b(c).html()+"</"+b(c).prop("tagName")+">";return b(e)},getHtmlBody:function(){return this._coBrowseHtmlData},updateHtmlBody:function(){return this._createInputField(),this._createSelectBox(),this._createTextArea(),this._createDiv(),this._createDataMaskingFields(),this._createImages(),this._createLinks(),this._doRemoveKnownHTML(),this._doRemoveUnwantedHTML(),this._doRemoveScript(),this._doCreateHtml5Tag(),this._createIframe(),this._coBrowseHtmlData}},a.Services.Cobrowse.Customer.CustomerCobrowseHtmlBody=c}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";function c(a,b){this._customerCobrowseWindow=a,this._coBrowseUtility=a._customerCobrowseService,this._coBrowseHtmlHead=b,this._updatedHtmlHead=""}c.prototype={_createLink:function(){var c=this;try{this._coBrowseHtmlHead.find("link").each(function(){if("cbeCSS"!==b(this).attr("id")){var a=b(this).attr("href"),d=b(this).attr("rel");if("stylesheet"===d.toLowerCase()){var e='<link rel="'+d+'"',f=a;a&&(0===a.indexOf("//")?f=window.location.protocol+a:0===a.indexOf("/")?f=c._coBrowseUtility.getDomainURL()+a:0!==a.indexOf("http")&&(f=c._coBrowseUtility.getBaseURL()+a));var g="";b.each(this.attributes,function(a,b){var c=b.name,d=b.value;"href"!==c&&"rel"!==c&&(g=" "+c+'="'+d+'"')}),e+=g+' href="'+f+'" />',c._updatedHtmlHead+=e}}})}catch(d){a.Base.CobrowseLogger.error("Exception in head cloning link: "+d)}},_createAgentCSSForHover:function(){this._customerCobrowseWindow._cssForAgentHoverSupport&&(this._updatedHtmlHead+=this._customerCobrowseWindow._cssForAgentHoverSupport,this._updatedHtmlHead+="<meta name='cssHover' content ='"+JSON.stringify(this._customerCobrowseWindow._psuedoCollection)+"'</meta>")},_createTitleandStyle:function(){var c=this;try{this._coBrowseHtmlHead.find("title, style").each(function(){var a=b(this).prop("tagName").toLowerCase(),d="";b.each(this.attributes,function(a,b){var c=b.name,e=b.value;d=" "+c+'="'+e+'"'});var e=b(this).html();c._updatedHtmlHead+="<"+a+d+">"+e+"</"+a+">"})}catch(d){a.Base.CobrowseLogger.error("Exception in head cloning title and style: "+d)}},getHtmlHead:function(){return this._updatedHtmlHead},updateHtmlHead:function(){return this._createLink(),this._createTitleandStyle(),this._createAgentCSSForHover(),this._updatedHtmlHead?this._updatedHtmlHead="<head>"+this._updatedHtmlHead+"</head>":this._updatedHtmlHead="<head></head>",this._updatedHtmlHead}},a.Services.Cobrowse.Customer.CustomerCobrowseHtmlHead=c}(AvayaCoBrowseClientServices,jQuery),function(a){"use strict";function b(){this._hover=void 0,this._md5=void 0,this._dom=void 0,this._h_dom_b64=void 0,this._md5_h=void 0,this._rPtr=void 0,this._titleNode=void 0,this._mask=void 0,this._scrollTop=0,this._scrollTopOld=0,this._scrollLeft=0,this._scrollLeftOld=0,this._removeElementList=[],this._hoverClass=void 0,this._cssForAgentHoverSupport=void 0,this._jsonData=void 0,this._jsonData=void 0,this._psuedoCollection=null}a.Services.Cobrowse.Customer.CustomerCobrowsePageData=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";function b(b){this._customerCobrowse=b,this._customerCobrowseProvider=new a.Providers.Cobrowse.Customer.CustomerCobrowseProvider,this._cobrowseConfig=null,this._coBrowseDataSet=new a.Base.CobrowseDataSet,a.Base.Observable.apply(this),a.Services.Cobrowse.Customer.CustomerCobrowseServiceData.apply(this)}function c(){return encodeURI(Base64.encode(window.location.href))}b.prototype=Object.create(a.Base.Observable.prototype),b.prototype.updateData=function(a){var b=this.getCustomerDataSet().coBrowseData;$.extend(b.coBrowseSessionInfo,a.acsResponse.coBrowseSessionInfo),$.extend(b.options,a.options),b.passPhrase=a.acsResponse.passPhrase,b.authKey=a.acsResponse.authKey,b.superVisor=a.acsResponse.superVisor,this.getCustomerDataSet().updateDataset(b)},b.prototype.getCustomerDataSet=function(){return this._coBrowseDataSet},b.prototype.init=function(a){return this._cobrowseConfig=a,this._customerCobrowseProvider.init(this._cobrowseConfig)},b.prototype.startSocketConnection=function(){this._customerCobrowseProvider.startSocketConnection()},b.prototype.requestSession=function(b){this._isAgentJoined=!1;var c=$.Deferred();b.eurl=this.getCurrentURL();var d=this._customerCobrowse.createRequestSessionArguments();$.extend(d,b);var e=function(b){var d=b.getMessage();a.Base.CobrowseLogger.error("Failed to request a session=>",d),c.reject(new a.Base.CoBrowseError(b.getErrorCode(),b.getReason(),d))},f=function(b){b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSSTATUSCODE&&b.acsResult===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSRESULT?(this.getCustomerDataSet().coBrowseData=new a.Base.CobrowseData,this.updateData(b),a.Base.CobrowseCookie.set("ACS_TOKEN",this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.custAuthCode,null),this.openConnection(),c.resolve(this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo)):b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.FAILSTATUSCODE&&(a.Base.CobrowseLogger.error("Failed to request a session",b.errorMessage),c.reject(new a.Base.CoBrowseError(b.errorCode,b.errorMessage,b.errorMessage)))};return this._customerCobrowseProvider.requestSession(b).then(f.bind(this),e),c.promise()},b.prototype.joinSession=function(b){var c=$.Deferred(),d=!0,e=function(b){var d=b.getMessage();a.Base.CobrowseLogger.error("Failed to join a session",d),c.reject(new a.Base.CoBrowseError(b.getErrorCode(),b.getReason(),d))},f=function(g){if(g&&g.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSSTATUSCODE&&g.acsResult===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSRESULT)$.extend(this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,g.acsResponse),$.extend(this.getCustomerDataSet().coBrowseData.options,g.options),this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.cobrowseState=a.Services.Cobrowse.Common.CobrowseState.COBROWSEINPROGRESSSTATE,a.Base.CobrowseCookie.set("ACS_TOKEN",this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.custAuthCode,null),this.openConnection(),c.resolve(this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo);else if(g&&g.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.REDIRECTSTATUSCODE&&d){d=!1,b.affinity=g.acsResponse;var h=this._customerCobrowse.createJoinSessionArguments();$.extend(h,b),this.getCustomerDataSet().coBrowseData.redirectURL=g.acsResponse,this._customerCobrowseProvider.joinSession(b).then(f.bind(this),e)}else g&&g.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.FAILSTATUSCODE&&c.reject(new a.Base.CoBrowseError(g.errorCode,"Unable to Join Session ("+g.errorMessage+")",g.errorMessage))};return this._customerCobrowseProvider.joinSession(b).then(f.bind(this),e),c.promise()},b.prototype.statusSession=function(b){var c,d=this,e=a.Base.CobrowseCookie.get("ACS_TOKEN");if(b?c=b:(c=d._customerCobrowse.createStatusArguments(),c.acstoken=e),!e)return d.shutdown(),void d.onReady({msg:"no active session found"});this._customerCobrowseProvider.statusSession(c).then(function(b){if(d._connRetryTimer&&(a.Base.CobrowseLogger.warn("Connected to Server! Stop retrying...."),clearInterval(d._connRetryTimer),d._connRetryTimer=null),b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSSTATUSCODE&&b.acsResult===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSRESULT){var e=d.getCustomerDataSet().coBrowseData;$.extend(e.coBrowseSessionInfo,b.acsResponse),$.extend(e.options,b.options),d.getCustomerDataSet().updateDataset(e),e.coBrowseSessionInfo.agentControlState===a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLPENDINGSTATE&&(d._ctrlReqPending=!0),d.onReady({resume:!0,msg:"Reconnecting...."}),d.openConnection()}else b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.REDIRECTSTATUSCODE&&!c.affinity?(c.affinity=b.acsResponse,d.getCustomerDataSet().coBrowseData.redirectURL=b.acsResponse,d.statusSession(c)):b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.NOSESSIONFOUNDSTATUSCODE?(d.shutdown(),d.onReady({msg:"no active session found"})):d.onReady({resume:!1,msg:"no active session found"})},function(b){d._connRetryTimer?d.onFail({msg:"Conn Err! Retrying.."}):(a.Base.CobrowseLogger.warn("init (error): "+JSON.stringify(b)),d.onReady({resume:!1,msg:"no active session found"}))})},b.prototype.logoutSession=function(b){var c=$.Deferred();this._connRetryTimer&&(clearInterval(this._connRetryTimer),this._connRetryTimer=null),void 0===b&&(b=this._customerCobrowse.createLogoutSessionArguments()),b.acstoken=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.custAuthCode,b.eurl=this.getCurrentURL();var d=this.getCustomerDataSet().coBrowseData.redirectURL;d&&""!==d&&(b.affinity=d);var e=function(b){var d=b.getMessage();a.Base.CobrowseLogger.error("Failed to logout a session",d),this.getCustomerDataSet().coBrowseData.redirectURL="",c.reject(new a.Base.CoBrowseError(b.getErrorCode(),b.getReason(),d))},f=function(b){b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSSTATUSCODE&&b.acsResult===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSRESULT?(this.shutdown(),this.clear(),this.getCustomerDataSet().coBrowseData.redirectURL="",c.resolve(this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo)):b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.FAILSTATUSCODE&&c.reject(new a.Base.CoBrowseError(b.errorCode,b.errorMessage,b.errorMessage))};return this._customerCobrowseProvider.logoutSession(b).then(f.bind(this),e.bind(this)),c.promise()},b.prototype.onReady=function(b){this.trigger(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_ONREADY,b)},b.prototype.onFail=function(b){this.trigger(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_FAIL,b)},b.prototype.onStart=function(b){this.trigger(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_START,b)},b.prototype.onControlRequest=function(b){this._ctrlReqPending?a.Base.CobrowseLogger.warn("Old request is still pending."):(a.Base.CobrowseLogger.info("onControlRequest: Agent wish to control the web page"),this._ctrlReqPending=!0,this.trigger(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_CONTROLREQUEST,b))},b.prototype.onControlRelease=function(b){this.trigger(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_CONTROLRELEASE,b)},b.prototype.onSessionClose=function(b){this.trigger(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_SESSIONCLOSE,b)},b.prototype.onAgentJoin=function(b){this.trigger(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_AGENTJOIN,b)},b.prototype.onAgentAlive=function(b){this.trigger(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_AGENTLIVE,b)},b.prototype.onAgentDead=function(b){this.trigger(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_AGENTDEAD,b)},b.prototype.rpcPause=function(){var b=$.Deferred(),d=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,e=this,f=function(c){var d=c.getMessage();a.Base.CobrowseLogger.error("Failed to pause a session",d),
b.reject(new a.Base.CoBrowseError(c.getErrorCode(),c.getReason(),d))},g=function(c){a.Base.CobrowseLogger.info("changeState to pause:: success: "+c),d.cobrowseState=a.Services.Cobrowse.Common.CobrowseState.COBROWSEPAUSEDSTATE,e.enableMouseSync.call(e,!1),e.stopViewSync.call(e),e.stopInactiveTimer(),b.resolve()};return this._customerCobrowseProvider.sendJsonRPC("customerservice","changeState",[d.custAuthCode,"Pause",c()]).then(g.bind(this),f),b.promise()},b.prototype.rpcResume=function(){var b=$.Deferred(),d=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,e=this,f=function(c){var d=c.getMessage();a.Base.CobrowseLogger.error("Failed to resume a session",d),b.reject(new a.Base.CoBrowseError(c.getErrorCode(),c.getReason(),d))},g=function(c){a.Base.CobrowseLogger.info("changeState to resume:: success: "+c),d.cobrowseState=a.Services.Cobrowse.Common.CobrowseState.COBROWSEINPROGRESSSTATE,e.enableMouseSync.call(e,!0),e.startViewSync.call(e,!1),e.startInactiveTimer(),b.resolve()};return this._customerCobrowseProvider.sendJsonRPC("customerservice","changeState",[d.custAuthCode,"resume",c()]).then(g.bind(this),f),b.promise()},b.prototype.rpcUpdateIdleTime=function(b){var d=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,e=this,f=b+60*e.getCustomerDataSet().coBrowseData.options["CB.INACTIVE_TIMEOUT"];e._customerCobrowseProvider.callJsonRPC("customerservice","inactiveTime",d.custAuthCode,f,c(),function(b){a.Base.CobrowseLogger.info("inactiveTime:: sent"+f+b)},function(b){a.Base.CobrowseLogger.error("inactiveTime:: Unable to update in audit log"+b)})},b.prototype.rpcGrantControl=function(){var b=$.Deferred(),d=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,e=function(c){var d=c.getMessage();a.Base.CobrowseLogger.error("Failed to grant control",d),b.reject(new a.Base.CoBrowseError(c.getErrorCode(),c.getReason(),d))},f=function(c){a.Base.CobrowseLogger.info("grantControl:: success: "+c),this._ctrlReqPending=!1,this.enableDrawMode(!1),this._customerCobrowseWindow.call(this._customerCobrowseWindow.cleanHighlightedNode,"",this._customerCobrowseWindow),this.startViewSync.call(this,!1),d.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE,this._customerCobrowseWindow.call(this._customerCobrowseWindow.activeElementBlur,"",this._customerCobrowseWindow),this.enableMouseSync(!1),this.stopViewSync(),a.Base.CobrowseLogger.info("[grantControl: Inner function] -- _agentControl: "+d.agentControlState),this._updateOnCtrlChg(!0),this.stopInactiveTimer(),this._cssForAgentHoverSupport&&$(this._cssForAgentHoverSupport).appendTo("head"),b.resolve()};return this._customerCobrowseProvider.sendJsonRPC("customerservice","grantControl",[d.custAuthCode,!0,c()]).then(f.bind(this),e),b.promise()},b.prototype.rpcDenyControl=function(){var b=$.Deferred(),d=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,e=function(c){var d=c.getMessage();a.Base.CobrowseLogger.error("Failed to deny control",d),b.reject(new a.Base.CoBrowseError(c.getErrorCode(),c.getReason(),d))},f=function(c){a.Base.CobrowseLogger.info("denyControl:: success: "+c),this._ctrlReqPending=!1,d.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLFALSESTATE,b.resolve()};return this._customerCobrowseProvider.sendJsonRPC("customerservice","grantControl",[d.custAuthCode,!1,c()]).then(f.bind(this),e),b.promise()},b.prototype.rpcRevokeControl=function(){var b=$.Deferred(),d=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,e=this,f=function(c){var d=c.getMessage();a.Base.CobrowseLogger.error("Failed to revoke control",d),b.reject(new a.Base.CoBrowseError(c.getErrorCode(),c.getReason(),d))},g=function(c){a.Base.CobrowseLogger.info("revokeControl:: success: "+c),d.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLFALSESTATE,e.enableMouseSync(!0),e._customerCobrowseWindow.call(this._customerCobrowseWindow.cleanHighlightedNode,"",this._customerCobrowseWindow),$(document).off("mousemove.cbiframeid"),$(document).on("mousemove.cbiframeid",function(a){e.iframeSelector="main"}),e.startViewSync.call(e,!1),e._updateOnCtrlChg(!1),e.startInactiveTimer(),this._cssForAgentHoverSupport&&e._customerCobrowseWindow.call(this._customerCobrowseWindow.removeAddedByAutomation,"",this._customerCobrowseWindow),b.resolve()};return this._customerCobrowseProvider.sendJsonRPC("customerservice","revokeControl",[d.custAuthCode,c()]).then(g.bind(this),f),b.promise()},b.prototype.rpcInactiveTime=function(b){var d=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo;this._customerCobrowseProvider.callJsonRPC("customerservice","inactiveTime",d.custAuthCode,b,c(),function(b){a.Base.CobrowseLogger.info("inactiveTime:: sent"+b)},function(b){a.Base.CobrowseLogger.error("inactiveTime:: Unable to update in audit log"+b)})},b.prototype.rpcSendMousePos=function(a){var b=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,c=this;c.resetInactiveCounter(),c._customerCobrowseProvider.callJsonRPC("customerservice","sendMousePos",b.custAuthCode,a)},b.prototype.rpcSendScrollPos=function(a){var b=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,c=this;c.resetInactiveCounter(),c._customerCobrowseProvider.callJsonRPC("customerservice","sendScrollPos",b.custAuthCode,a)},b.prototype.rpcSendViewUpdate=function(b){var c=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo;this._customerCobrowseProvider.callJsonRPC("customerservice","sendViewUpdate",c.custAuthCode,b,function(b){a.Base.CobrowseLogger.info("////////////////////////////// View Update sent //////////////////////////////////////"+b)},function(b){a.Base.CobrowseLogger.warn("////////////////////////////// Unable to send view update //////////////////////////////////////"+b)})},b.prototype.rpcOnConnection=function(){var b=this,c=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo;b._customerCobrowseProvider.callJsonRPC("customerservice","onConnection",c.custAuthCode,b._customerCobrowseProvider.getProtocol.call(b._customerCobrowseProvider),function(c){a.Base.CobrowseLogger.info("onConnection:: onConnection send to agent: "+c),b.startOnConnection.call(b)},function(b){a.Base.CobrowseLogger.error("startSession:: Error occurred while sending onConnection: to agent"+b)})},b.prototype.rpcConnectToAnAgent=function(){var b=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,d=this,e=!1,f=!1;b.agentControlState===a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE&&(f=!0),b.cobrowseState===a.Services.Cobrowse.Common.CobrowseState.COBROWSEPAUSEDSTATE&&(e=!0),d._customerCobrowseProvider.callJsonRPC("customerservice","connectToAnAgent",b.custAuthCode,d._customerCobrowseProvider.getProtocol.call(d._customerCobrowseProvider),c(),function(c){a.Base.CobrowseLogger.info("startSession:: Session established. msg: "+c);var g=d.getCustomerDataSet().coBrowseData;d.getCustomerDataSet().updateDataset(g),d.onStart({paused:e,agentControl:f,agentName:b.agentName,customerName:b.customerName,ctrlReqPending:d._ctrlReqPending,key:b.passPhrase}),e||f?d.stopInactiveTimer():d.startInactiveTimer(),d.registerCallbacks(),d.rpcOnConnection()},function(b){a.Base.CobrowseLogger.error("startSession:: Error occurred while establishing the session"),d.onFail({msg:"Unable to Join Session ("+b.message+")"})})},b.prototype.openConnection=function(){var b=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,c=this;if(!b.custAuthCode)return void c.onFail({msg:"Unable to open Connection (Session expired!)"});if(this._customerCobrowseProvider.attachNetworkEvent(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_OPEN,function(){try{c.rpcConnectToAnAgent.call(c)}catch(a){c.onFail({msg:"Unable to Join Session (Unknown Error)"})}}),c._customerCobrowseProvider.attachNetworkEvent(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_CLOSE,function(b){if(a.Base.CobrowseLogger.error("evtConnectionClose:: connection closed :SockJS: "+JSON.stringify(b)),1006===b.code?(c.onFail({msg:"Conn Err! Retrying.."}),c.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.agentControlState===a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE&&(c.stopViewSync(),c._updateOnCtrlChg(!0))):c.onFail({msg:"Connection closed :SockJS ("+b+")"}),!c._connRetryTimer){var d=c.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.custAuthCode;c.shutdown(),a.Base.CobrowseCookie.set("ACS_TOKEN",d,null),c._connRetryTimer=setInterval(function(){c.resetInactiveCounter(),a.Base.CobrowseLogger.warn("evtConnectionClose:: retrying to connect again"),c.statusSession()},c._connRetryInterval)}}),c.getCustomerDataSet().coBrowseData.redirectURL){var d=a.Providers.Cobrowse.Customer.CustomerCobrowseURLProvider.SOCKETSERVICEURL+"/?affinity="+c.getCustomerDataSet().coBrowseData.redirectURL;c._customerCobrowseProvider.startSocketConnection(d)}else c._customerCobrowseProvider.startSocketConnection()},b.prototype.psuedoSupport=function(b){if(this._inputJsonForPsuedo=b,this._inputJsonForPsuedo)try{JSON.parse(this._inputJsonForPsuedo).navigate&&this._customerCobrowseWindow.call(this._customerCobrowseWindow._configurePsuedo,"",this._customerCobrowseWindow)}catch(c){a.Base.CobrowseLogger.warn("Improper usage of API refer to documentation ::"+c)}},b.prototype.dropdownSupport=function(){this._isDropDownEnable=!0},a.Services.Cobrowse.Customer.CustomerCobrowseService=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(){this._vSyncTimer=void 0,this._hover=void 0,this._md5=void 0,this._dom=void 0,this._h_dom_b64=void 0,this._md5_h=void 0,this._vSyncInterval=1200,this._mmSyncInterval=900,this._mmSyncTimer=void 0,this._isTitleEnable=!0,this._mask=void 0,this._mLocalNode=void 0,this._mNodeCssOld=void 0,this._mNodeCss=void 0,this._mElement=void 0,this._mX=0,this._mY=0,this._mXO=0,this._mYO=0,this._isHighilightEnabled=!0,this._isMarkerEnabled=!1,this._agentViewSyncInterval=500,this._scrollTop=0,this._scrollTopOld=0,this._scrollLeft=0,this._scrollLeftOld=0,this._inactiveCounter=0,this.backgroundColor="yellow",this._markerBGColor="yellow",this._ctrlReqPending=!1,this._connRetryTimer=null,this._connRetryInterval=1e4,this._inactiveTimer=null,this._inactiveCounter=0,this._inactiveInterval=5e3,this._removeElementList=[],this._isAgentJoined=!0,this._inputJsonForPsuedo=void 0,this._cssForAgentHoverSupport=void 0,this._customerCobrowseWindow=void 0,this._bSendDataForIFrames=!1,this._offsetX=0,this._offsetY=0,this._drawType=void 0,this._svg=void 0,this.iframeSelector="main",this._isDropDownEnable=!1}a.Services.Cobrowse.Customer.CustomerCobrowseServiceData=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";function b(b,c,d,e){this._pageDocument=b,this._customerCobrowseService=c,this._iframes=[],this._iframeSelector=d,this._cbWindow=e,a.Services.Cobrowse.Customer.CustomerCobrowsePageData.apply(this)}b.prototype.call=function(a,b,c){a.call(c,b),this._iframes.length>0&&$.each(this._iframes,function(c,d){this.call(a,b,d)})},b.prototype.addIframeWindow=function(a){this._iframes.push(a)},b.prototype.addMaskElements=function(){this._pageDocument.find(".avcobrowse-mask").after('<div class="cbe-mask-help" title="This field is hidden from Agent" />'),this._pageDocument.find(".avcobrowse-block").before('<div class="cbe-block-help" title="This Action is blocked for the Agent" />')},b.prototype.removeMaskElements=function(a){void 0===a&&(a=!1),this._pageDocument.find(".cbe-mask-help").remove(),this._pageDocument.find(".cbe-block-help").remove(),a&&$(this._cbWindow).off("resize.onDemandUpdate")},b.prototype.refreshMaskElements=function(){this.removeMaskElements(),this.addMaskElements()},b.prototype.updateOnCtrlChg=function(a){this._pageDocument.find("#cbePtr").remove(),this._pageDocument.find("#cbeMask").remove(),this._pageDocument.find("#cbtooltip").remove(),this._pageDocument.find("body").css("cursor","auto"),this._pageDocument.find("body").find("input").unbind("keydown",this.disableTabControl),this._pageDocument.find("body").find("a").unbind("keydown",this.disableTabControl),a&&(this._rPtr=$('<div id="cbePtr" class="cbe-remote-cursor"></div>'),this._mask=$('<div id="cbeMask" class="cbe-readonly-mask"></div>').css({width:this._pageDocument.width(),height:this._pageDocument.height()}),this._titleNode=$('<div id="cbtooltip" class="cbtooltip"></div>'),this._pageDocument.find("body").append(this._mask,this._rPtr,this._titleNode),this._pageDocument.find("body").css("cursor","not-allowed"),this._pageDocument.find("body").find("input").bind("keydown",this.disableTabControl),this._pageDocument.find("body").find("a").bind("keydown",this.disableTabControl),this._cssForAgentHoverSupport&&this._pageDocument.find("head").append(this._cssForAgentHoverSupport))},b.prototype.startViewSync=function(b){if(!this._vSyncCheck(b)){this._customerCobrowseService._vSyncTimer&&clearTimeout(this._customerCobrowseService._vSyncTimer);var c=this._customerCobrowseService;return this._customerCobrowseService._vSyncTimer=setTimeout(function(){c.vSyncTimerFunc.call(c)},c._vSyncInterval),void a.Base.CobrowseLogger.info("No Change, Check after "+this._customerCobrowseService._vSyncInterval+" ms")}this._customerCobrowseService._vSyncTimer&&clearTimeout(this._customerCobrowseService._vSyncTimer);var d={data:this._dom,cssData:this._h_dom_b64,iframeSelector:this._iframeSelector,windowSize:JSON.stringify({w:$(this._cbWindow).width(),h:$(this._cbWindow).height()}),scrollPosition:JSON.stringify({scrollX:$(this._cbWindow).scrollLeft(),scrollY:$(this._cbWindow).scrollTop()})};this._customerCobrowseService.rpcSendViewUpdate(d)},b.prototype._vSyncCheck=function(b){if(b&&!0===b)return a.Base.CobrowseLogger.info("[AgentInControl] Pushing OnDemand Update"),this._md5="",this._md5_h="",this._dom=this._vSyncCreate(!0),this._iframes=[],this._customerCobrowseService.createCobrowseWindow(this,this._customerCobrowseService),a.Base.CobrowseLogger.info("DOM Length (b64) = "+this._dom.length),!0;var c=this._vSyncCreate(!1),d=md5(c);return this._md5!==d?(this._md5=d,this._dom=Base64.encode(c),this._iframes=[],this._customerCobrowseService.createCobrowseWindow(this,this._customerCobrowseService),a.Base.CobrowseLogger.info("$$ view update available len (b64) = "+this._dom.length),!0):(a.Base.CobrowseLogger.info("%% checksum optimization: nothing available"),!1)},b.prototype._vSyncCreate=function(b){this.createHeadSection(),a.Base.CobrowseLogger.info("/////////////////// View PRE-PROCESSING BEGIN /////////////////// ");var c=this._pageDocument;try{c=this._pageDocument.find("body").clone(!0,!0),this._customerCobrowseService._customerCobrowseWindow._cssForAgentHoverSupport&&c.append(this._customerCobrowseService._customerCobrowseWindow._cssForAgentHoverSupport)}catch(d){a.Base.CobrowseLogger.info("Exception while cloning body: "+d)}return c=new a.Services.Cobrowse.Customer.CustomerCobrowseHtmlBody(this,c).updateHtmlBody(),a.Base.CobrowseLogger.info("/////////////////// View PRE-PROCESSING END /////////////////// "),b?Base64.encode(c.html()):c.html()},b.prototype.createHeadSection=function(){var b=this._pageDocument.find("head");try{b=this._pageDocument.find("head").clone(!0,!0)}catch(d){a.Base.CobrowseLogger.info("Exception while cloning head: "+d)}b=new a.Services.Cobrowse.Customer.CustomerCobrowseHtmlHead(this,b).updateHtmlHead();var c=md5(b);this._md5_h!==c?(this._md5_h=c,this._h_dom_b64=Base64.encode(b),a.Base.CobrowseLogger.warn("head section change detected - (Y)")):this._h_dom_b64=null},b.prototype.removeLocalNode=function(){this._customerCobrowseService._mLocalNode&&(this._customerCobrowseService._mLocalNode.remove(),a.Base.CobrowseLogger.info("enableMouseSync: removing highlight"))},b.prototype.bindEvent=function(a,b){$(this._pageDocument).bind(a,b)},b.prototype.unbindEvent=function(a){$(this._pageDocument).unbind(a)},b.prototype.unbindEventWithHandler=function(){var a=this;this._pageDocument.find("a, input, textarea, select, option, optgroup, button, fieldset, legend, img, area, map, object, li").each(function(){$(this).unbind("focusin",a._customerCobrowseService.highlightIn),$(this).unbind("mouseenter",a._customerCobrowseService.highlightIn),$(this).unbind("click",a._customerCobrowseService.highlightIn)})},b.prototype.handleMouseUp=function(){var a=this;$(this._pageDocument).mouseup(function(){a.highlightText()}),$(this._pageDocument).mousemove(function(b){a._customerCobrowseService._mX=b.pageX-3,a._customerCobrowseService._mY=b.pageY-4,a._customerCobrowseService._mElement=b.target}),$(this._pageDocument).keyup(function(){a._customerCobrowseService.resetInactiveCounter()}),this._pageDocument.find("a, input, textarea, select, option, optgroup, button, fieldset, legend, img, area, map, object, li").each(function(){a._customerCobrowseService.highlightElement($(this),a._customerCobrowseService)})},b.prototype.highlightText=function(){var a,b=this._customerCobrowseService;if(b._isAgentJoined&&b._isHighilightEnabled){var c=this.getTextRange();a=this.cleanHighlightedNode(),c&&c.length>0&&(this.createRangeAndHighlight(c),a=!0),a&&b.startViewSync.call(b,!1)}},b.prototype.markText=function(){var a,b=this._customerCobrowseService;if(b._isAgentJoined&&b._isMarkerEnabled){var c=this.getTextRange();c&&c.length>0&&(this.createRangeAndHighlight(c),a=!0),a&&b.startViewSync.call(b,!1)}},b.prototype.getBaseURL=function(){var a=location.href,b=a.length,c={fragment:"#",query:"?",path:"/"};return $.each(c,function(c,d){a.lastIndexOf(d)>0&&(b=a.lastIndexOf(d),a=a.substring(0,b+1))}),a},b.prototype.onScroll=function(a){null!==a&&(navigator.userAgent.match(/(iPod|iPhone|iPad)/)?this._cbWindow.scrollTo(a.scrollLeft,a.scrollTop):"main"===this._iframeSelector?$("html,body").animate({scrollTop:a.scrollTop,scrollLeft:a.scrollLeft},500):this._cbWindow.scrollTo(a.scrollLeft,a.scrollTop))},b.prototype.onMousePos=function(b){if(null!==b){var c=this.getElementInDocument(null,b.cssSelector);if(c&&(this._customerCobrowseService._mLocalNode&&this._customerCobrowseService._mLocalNode.remove(),this._pageDocument.find("body").append(this._customerCobrowseService.highlight(c))),null===this._rPtr||void 0===this._rPtr)return;var d,e,f=b.mX,g=b.mY;if(b&&b.nodeCSSSelector&&"undefined"!==b.nodeCSSSelector)try{d=this._pageDocument.find(b.nodeCSSSelector).get(0);var h=b.nodeCSSSelector,i=["html","body"];!d&&h&&$.each(i,function(a,b){!d&&h.startsWith(b)&&h.length>h.indexOf(">")+1&&(h=h.substring(h.indexOf(">")+1),d=this._pageDocument.find(h).get(0))})}catch(l){a.Base.CobrowseLogger.error("Exception in finding mouse node: "+l)}if(d){var j=$(d).offset();j&&(f=parseInt(j.left)+$(d).width()*parseFloat(b.nodeX),g=parseInt(j.top)+$(d).height()*parseFloat(b.nodeY)),$(d).attr("title")?e=$(d).attr("title"):$(d).parents("[title]")[0]&&(e=$($(d).parents("[title]")[0]).attr("title"))}else f=b.mX,g=b.mY;if(f!==this._customerCobrowseService._mX||g!==this._customerCobrowseService._mY){this._customerCobrowseService._mX=f,this._customerCobrowseService._mY=g;var k={left:f,top:g};this.setMousePositionOnUpdate(f,g),e&&this._customerCobrowseService._isTitleEnable?(this._titleNode.empty(),this._titleNode.append(e),this._titleNode.css({top:this._customerCobrowseService._mY+this._rPtr.height(),left:this._customerCobrowseService._mX+this._rPtr.width()}),this._titleNode.show()):this._titleNode.hide(),this._customerCobrowseService.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_AGENT_MOUSE_UPDATE,k)}}},b.prototype.setMousePoistionRecusrsively=function(a){a._rPtr.hide();for(var b=0;b<a._iframes.length;b++)a._iframes[b]._rPtr||(a._iframes[b]._rPtr=$('<div id="cbePtr" class="cbe-remote-cursor"></div>'),a._iframes[b]._mask=$('<div id="cbeMask" class="cbe-readonly-mask"></div>').css({width:a._iframes[b]._pageDocument.width(),height:a._iframes[b]._pageDocument.height()}),a._iframes[b]._titleNode=$('<div id="cbtooltip" class="cbtooltip"></div>')),this.setMousePoistionRecusrsively(a._iframes[b])},b.prototype.setMousePositionOnUpdate=function(a,b){this.setMousePoistionRecusrsively(this._customerCobrowseService._customerCobrowseWindow),this._rPtr.show(),this._rPtr.css({top:b-3+"px",left:a-3+"px"})},b.prototype.updateOnWindowResize=function(){$(this._cbWindow).off("resize.onDemandUpdate"),$(this._cbWindow).on("resize.onDemandUpdate",this._customerCobrowseService.onDemandUpdate.bind(this._customerCobrowseService))},b.prototype.highlightOnAgentTouch=function(a){a.addClass("cbe-radio-agent-touch")},b.prototype.getElementInDocument=function(a,b){a&&a.length>0&&("."===a.substring(a.length-1)||"#"===a.substring(a.length-1)||"#"===a.substring(a.length-1))&&(a=a.substring(0,a.length-1));var c;if(a&&(c=this._pageDocument.find("#"+a)),(!c||c&&0===c.length)&&(c=this._pageDocument.find(b)),void 0!==c)return c.length>0?c.get(0):void 0},b.prototype.onRemoteClickAction=function(a){a.click(),$(a).is(":radio")||$(a).is(":checkbox")?(this._customerCobrowseService.highlightOnAgentTouch($(a)),$(a).blur()):-1!==a.className.indexOf("select2")&&-1!==a.className.indexOf("-result")?$(a).mouseup():-1!==a.className.indexOf("select2")&&($(a).mousedown(),$(a).parent().parent().parent().addClass("cbe-agent-touch"))},b.prototype.onRemoteKeyUpAction=function(a,b){if(b.value&&($(a).val(b.value).trigger("input"),$(a).addClass("cbe-agent-touch")),b.scrollTop&&$(a).scrollTop(b.scrollTop),"text"===b.type&&null!==b.index&&"13"===b.index){b.keycode="13",b.index="";var c=$.Event("keyup");c.keyCode=13,$(a).trigger(c,b),this._customerCobrowseService.repeatedViewSync()}this._vSyncCheck(!1)},b.prototype.onRemoteDivScrollAction=function(a,b){$(a).scrollTop(b)},b.prototype.onRemoteFocusAction=function(a,b){"text"===b.type&&($(a).val(b.value),$(a).addClass("cbe-agent-touch"),this._vSyncCheck(!1),$(a).trigger(b.event,b))},b.prototype.onRemoteHoverInAction=function(a){$(a).mouseenter()},b.prototype.onRemoteHoverOutAction=function(a){$(a).mouseleave()},b.prototype.onRemoteSelectAction=function(a,b){"text"===b.type?($(a).val(b.value),$(a).addClass("cbe-agent-touch"),$(a).trigger(b.event,b)):b.index&&(a.selectedIndex=b.index,$(a).addClass("cbe-agent-touch"),$(a).trigger(b.event,b)),this._customerCobrowseService.repeatedViewSync()},b.prototype.onRemoteMouseInOutAction=function(b,c){try{$(b).trigger(c.event),this._customerCobrowseService.repeatedViewSync()}catch(d){a.Base.CobrowseLogger.error("Error in event trigger: "+d)}},b.prototype.doScrollSync=function(){if(this._scrollLeft=$(this._cbWindow).scrollLeft(),this._scrollTop=$(this._cbWindow).scrollTop(),this._scrollTop!==this._scrollTopOld||this._scrollLeft!==this._scrollLeftOld){this._inactiveCounter=0,this._scrollLeftOld=this._scrollLeft,this._scrollTopOld=this._scrollTop;var a={event:"scroll",scrollTop:this._scrollTop,scrollLeft:this._scrollLeft,iframeSelector:this._customerCobrowseService.iframeSelector};this._customerCobrowseService.rpcSendScrollPos(a)}},b.prototype.setViewEmpty=function(){this._md5="",this._dom="",this._md5_h="",this._h_dom_b64=null},b.prototype.cleanOnShutdown=function(){this.cleanHighlightedNode(),this.cleanMarkedNode(),this.removeMaskElements(!0),this.setViewEmpty(),$(this._pageDocument).off("mousemove.cbiframeid")},b.prototype.activeElementBlur=function(){$(this._pageDocument).get(0).activeElement.blur()},b.prototype.removeAddedByAutomation=function(){this._pageDocument.find(".addedByAutomation").remove()},b.prototype.dropdownSupport=function(){this._pageDocument.find("select").select2({minimumResultsForSearch:1/0,dropdownParent:$(this._pageDocument.find("body"))})},b.prototype.removeDropdownSupport=function(){$.each(this._pageDocument.find("select"),function(a,b){$(b).data("select2")&&$(b).select2("destroy")})},a.Services.Cobrowse.Customer.CustomerCobrowseWindow=b}(AvayaCoBrowseClientServices),function(a,b){"use strict";function c(c){this._cobrowseConfig=c,this._customerCobrowseService=new a.Services.Cobrowse.Customer.CustomerCobrowseService(this),this._addOnfireInactivityCallbacks=b.Callbacks(),this._addOnStopInactivityTimerCallbacks=b.Callbacks(),this._coBrowseCapability=new a.Base.CoBrowseCapability(a.Base.CobrowseCapabilityDenialReason.CAPABILITY_INVALID_STATE),this._init()}c.prototype={_init:function(){if(!this._cobrowseConfig)throw"Cobrowse configuration is not defined.";this._customerCobrowseService.init(this._cobrowseConfig).then(function(b){"success"!==b.acsResult&&a.Base.CobrowseLogger.error("Cobrowse configuration is not correct, error while communicating with server"),this._coBrowseCapability._updateIfChanged(!0,a.Base.CobrowseCapabilityDenialReason.CAPABILITY_NOT_DENIED),a.Base.CobrowseLogger.info("Successfully initialized cobrowse service")}.bind(this),function(b){a.Base.CobrowseLogger.error("Cobrowse configuration is not correct, error while communicating with server==>"+b)})},getCustomerData:function(){return this._customerCobrowseService.getCustomerDataSet()&&this._customerCobrowseService.getCustomerDataSet().coBrowseData?this._customerCobrowseService.getCustomerDataSet().coBrowseData.coBrowseSessionInfo:new a.Base.CobrowseSessionInfo},requestSession:function(a,b,c){return this._customerCobrowseService.requestSession({name:a,locale:b,emailid:c})},joinSession:function(a,b,c){return this._customerCobrowseService.joinSession({name:a,sessionkey:b,emailid:c})},start:function(){this._customerCobrowseService.statusSession()},logoutSession:function(a){return this._customerCobrowseService.logoutSession({reason:a})},grantControl:function(){return this._customerCobrowseService.rpcGrantControl()},denyControl:function(){return this._customerCobrowseService.rpcDenyControl()},revokeControl:function(){return this._customerCobrowseService.rpcRevokeControl()},pause:function(){return this._customerCobrowseService.rpcPause()},resume:function(){return this._customerCobrowseService.rpcResume()},updateIdleTime:function(a){this._customerCobrowseService.rpcUpdateIdleTime(a)},addElementIDToRemove:function(a){this._customerCobrowseService.addElementIDToRemove(a)},enableHighlight:function(){this._customerCobrowseService.enableHighlight(!0)},enableMarker:function(){this._customerCobrowseService.enableMarker(!0)},enableTitle:function(){this._customerCobrowseService.enableTitle(!0)},disableTitle:function(){this._customerCobrowseService.enableTitle(!1)},disableHighlight:function(){this._customerCobrowseService.enableHighlight(!1)},disableMarker:function(){this._customerCobrowseService.enableMarker(!1)},setHighlightColor:function(a){this._customerCobrowseService.setHighlightColor(a)},setMarkerColor:function(a){this._customerCobrowseService.setMarkerColor(a)},setCustomerConnectionRetryInterval:function(a){this._customerCobrowseService.setConnectionRetryInterval(a)},setMouseAndScrollSyncInterval:function(a){this._customerCobrowseService.setMouseAndScrollSyncInterval(a)},setAgentViewSyncInterval:function(a){this._customerCobrowseService.setAgentViewSyncInterval(a)},setCSSHoverFile:function(a){this._customerCobrowseService.psuedoSupport(a)},dropdownSupport:function(){this._customerCobrowseService.dropdownSupport()},setDrawType:function(a){return this._customerCobrowseService.setDrawType(a)},enableDrawMode:function(){return this._customerCobrowseService.enableDrawMode(!0)},disableDrawMode:function(){return this._customerCobrowseService.enableDrawMode(!1)},clear:function(){this._customerCobrowseService.clear()}},a.Services.Cobrowse.Customer.CustomerCobrowse=c}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";function c(a,b){this._sColor=void 0===a?"red":a,this._sSize=void 0===b?"5":b}c.prototype={setStrokeColor:function(a){this._sColor=a},setStrokeSize:function(a){this._sSize=a}},a.Services.Cobrowse.Customer.CustomerDrawFreeHand=c}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";function c(a,b){this._sColor=void 0===a?"red":a,this._sSize=void 0===b?"5":b}c.prototype={setStrokeColor:function(a){this._sColor=a},setStrokeSize:function(a){this._sSize=a}},a.Services.Cobrowse.Customer.CustomerDrawShapeCircle=c}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";function c(a,b){this._sColor=void 0===a?"red":a,this._sSize=void 0===b?"5":b}c.prototype={setStrokeColor:function(a){this._sColor=a},setStrokeSize:function(a){this._sSize=a}},a.Services.Cobrowse.Customer.CustomerDrawShapeRectangle=c}(AvayaCoBrowseClientServices,jQuery),function(a){"use strict";var b={EVENT_ON_ONREADY:"cbprovider.onReady",EVENT_ON_START:"cbprovider.onStart",EVENT_ON_FAIL:"cbprovider.onFail",EVENT_ON_CONTROLREQUEST:"cbprovider.onControlRequest",EVENT_ON_CONTROLRELEASE:"cbprovider.onControlRelease",EVENT_ON_SESSIONCLOSE:"cbprovider.onSessionClose",EVENT_ON_AGENTJOIN:"cbprovider.onAgentJoin",EVENT_ON_AGENTLIVE:"cbprovider.onAgentAlive",EVENT_ON_AGENTDEAD:"cbprovider.onAgentDead",EVENT_ON_AGENT_MOUSE_UPDATE:"cbprovider.onAgentMouseUpdate"};a.Services.Cobrowse.Customer.ObservableCustomerEvents=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a,b){"use strict";var c={addOnPauseCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_PAUSE,b)},removeOnPauseCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_PAUSE,b)},addOnResumeCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_RESUME,b)},removeOnResumeCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_RESUME,b)},addOnControlGrantCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CONTROL_GRANT,b)},removeOnControlGrantCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CONTROL_GRANT,b)},addOnControlDenialCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CONTROL_DENIAL,b)},removeOnControlDenialCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CONTROL_DENIAL,b)},addOnControlRevokeCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CONTROL_REVOKE,b)},removeOnControlRevokeCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CONTROL_REVOKE,b)},addOnSessionCloseCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_SESSION_CLOSE,b)},removeOnSessionCloseCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_SESSION_CLOSE,b)},addOnCustomerJoinCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTOMER_JOIN,b)},removeOnCustomerJoinCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTOMER_JOIN,b)},addOnConnectionCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_START,b)},removeOnConnectionCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_START,b)},addOnConnectionFailureCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_FAIL,b)},removeOnConnectionFailureCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_FAIL,b)},addOnInActivityTimeOutOccurredCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_INACTIVITY_TIMEOUT,b)},removeOnInActivityTimeOutOccurredCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_INACTIVITY_TIMEOUT,b)},addOnStopInActivityTimeOutCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_STOPINACTIVITY_TIMEOUT,b)},removeOnStopInActivityTimeOutCallback:function(b){
this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_STOPINACTIVITY_TIMEOUT,b)},addOnCustomerDeadCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTOMER_DEAD,b)},removeOnCustomerDeadCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTOMER_DEAD,b)},addOnCoBrowseWindowResizeCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTSCREEN_RESIZE,b)},removeOnCoBrowseWindowResizeCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTSCREEN_RESIZE,b)},addOnCoBrowseWindowScrollChangeCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTSCREEN_SCROLL_CHANGE,b)},removeOnCoBrowseWindowScrollChangeCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTSCREEN_SCROLL_CHANGE,b)},addOnMouseMoveCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUST_MOUSE_UPDATE,b)},removeOnMouseMoveCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUST_MOUSE_UPDATE,b)}};b.extend(a.Services.Cobrowse.Agent.AgentCobrowse.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";var c={enableMouseSync:function(c){var d=this;if(this._agentCobrowseWindow.call(this._agentCobrowseWindow.removeLocalNode,[],this._agentCobrowseWindow),d.getAgentDataSet().coBrowseData.coBrowseSessionInfo.cobrowseState===a.Services.Cobrowse.Common.CobrowseState.COBROWSEPAUSEDSTATE||d.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState!==a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE||!c)return d._mmSyncTimer&&clearInterval(d._mmSyncTimer),a.Base.CobrowseLogger.info("Skip _mmSync: paused or agentControl"),void(b(this._iframeDivSelector).length>0&&b(this._iframeDivSelector).contents().unbind("mousemove"));var e=function(a){d._mX=a.pageX-3,d._mY=a.pageY-4,d._mElement=a.target},f=["mousemove",e];this._agentCobrowseWindow.call(this._agentCobrowseWindow.bindEvent,f,this._agentCobrowseWindow),this._mmSyncTimer=setInterval(function(){d.mmSync.call(d)},d._mmSyncInterval)},doScrollSync:function(){var c=null,d=null;if(this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState===a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE&&(b(this._iframeDivSelector).length>0&&(c=b(this._iframeDivSelector).contents().scrollLeft(),d=b(this._iframeDivSelector).contents().scrollTop()),d!==this._scrollTopOld||c!==this._scrollLeftOld)){this._scrollLeftOld=c,this._scrollTopOld=d;var e={scrollTop:d,scrollLeft:c,iframeSelector:this._iframeSelector};this.rpcSendScrollPos(e)}},mmSync:function(){if(this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState===a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE){if(this._mX!==this._mXO||this._mY!==this._mYO||this._mNodeCss!==this._mNodeCssOld){this._mXO=this._mX,this._mYO=this._mY,this._mNodeCssOld=this._mNodeCss,this._inactiveCounter=0;var c,d,f=0,g=0;if(this._mElement){c=b(this._mElement).offset();try{d=b(this._mElement).getPath()}catch(e){return void a.Base.CobrowseLogger.info("Error in finding getPath"+e)}}c&&(parseInt(b(this._mElement).width())>0&&(f=(parseInt(this._mX)-parseInt(c.left))/parseInt(b(this._mElement).width())),parseInt(b(this._mElement).height())>0&&(g=(parseInt(this._mY)-parseInt(c.top))/parseInt(b(this._mElement).height())));var h={event:"mousemove",mX:this._mX,nodeX:f,mY:this._mY,nodeY:g,id:this._mNodeId,cssSelector:this._mNodeCss,nodeCSSSelector:d,iframeSelector:this._iframeSelector};this.rpcSendMousePos(h)}var i=this.getAgentCoBrowseWindow(this._iframeSelector,this._agentCobrowseWindow);i.doScrollSync.call(i)}},onMouseUpdateCallBack:function(a){if(null!==a){this.getAgentCoBrowseWindow(a.iframeSelector,this._agentCobrowseWindow).onMouseUpdate(a)}},onScrollUpdateCallBack:function(b){if(null!==b){a.Base.CobrowseLogger.info("on Scroll Update : "+b);this.getAgentCoBrowseWindow(b.iframeSelector,this._agentCobrowseWindow).onScrollUpdate(b)}},getTextRange:function(){var c=[],d=null,e=null,f=this.getAgentCoBrowseWindow(this._iframeSelector,this._agentCobrowseWindow)._cbWindow,g=f&&f.document;try{if(f.getSelection?(d=f.getSelection().getRangeAt(0),e=f.getSelection().toString()):g.selection&&"Control"!==g.selection.type&&(d=g.selection().createRange().getRangeAt(0),e=g.selection.createRange().text),!e)return;var h=d.startContainer,i=d.endContainer,j=d.commonAncestorContainer;c[0]=d.startOffset,c[1]=d.endOffset,h&&3===h.TEXT_NODE?(c[2]=b(h.parentNode).getPath(),c[3]=Array.prototype.indexOf.call(h.parentNode.childNodes,h)):(c[2]=b(h).getPath(),c[3]=-1),i&&3===i.TEXT_NODE?(c[4]=b(i.parentNode).getPath(),c[5]=Array.prototype.indexOf.call(i.parentNode.childNodes,i)):(c[4]=b(i).getPath(),c[5]=-1),c[6]=b(j).getPath()}catch(k){a.Base.CobrowseLogger.warn("error is: "+k.message)}return c},onMouseSelCallBack:function(){this.rpcOnMouseSel()}};b.extend(a.Services.Cobrowse.Agent.AgentCobrowseService.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";var c={createRequestSessionArguments:function(){return{apikey:"defaultapikey",extkey:void 0,name:void 0,autoJoin:!1,locale:"en_US",emailid:void 0}},createJoinSessionArguments:function(){return{acstoken:void 0,useragent:void 0}},createLiveJoinSessionArguments:function(){return{sessionkey:void 0,name:void 0,clientname:void 0,emailid:void 0,extkey:void 0}},createStatusArguments:function(){return{acstoken:void 0}},createLogoutSessionArguments:function(){return{acstoken:void 0,reason:"logout",eurl:void 0}}};b.extend(a.Services.Cobrowse.Agent.AgentCobrowse.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";var c={onGetNextViewUpdateCallBack:function(){this.startViewSync.call(this,!1)},onControlRequestCallBack:function(){if(this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.agentControlState===a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE)a.Base.CobrowseLogger.info("Agent is already have control.");else{var b=this.getCustomerDataSet().coBrowseData;b.coBrowseSessionInfo.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLPENDINGSTATE,this.getCustomerDataSet().updateDataset(b),this.onControlRequest({agent:this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.agentName})}},onControlReleaseCallBack:function(){var c=this.getCustomerDataSet().coBrowseData;c.coBrowseSessionInfo.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLFALSESTATE,this.getCustomerDataSet().updateDataset(c),this.onControlRelease({agent:c.coBrowseSessionInfo.agentName}),this.startInactiveTimer(),this.enableMouseSync(!0),this._customerCobrowseWindow.call(this._customerCobrowseWindow.cleanHighlightedNode,"",this._customerCobrowseWindow);var d=this;b(document).off("mousemove.cbiframeid"),b(document).on("mousemove.cbiframeid",function(a){d.iframeSelector="main"}),this.startViewSync.call(this,!1),this._updateOnCtrlChg(!1)},onRemoteActionCallBack:function(a){if(null!==a){var c;if(b(a.cssSelector).hasClass("avcobrowse-mask"))return;if(b(a.cssSelector).hasClass("avcobrowse-block"))return;var d=this.getCustomerCoBrowseWindow(a.iframeSelector,this._customerCobrowseWindow);if(!d.getElementInDocument(a.id,a.cssSelector))return;c=d.getElementInDocument(a.id,a.cssSelector),"click"===a.event?(d.onRemoteClickAction(c),this.repeatedViewSync()):"keyup"===a.event?d.onRemoteKeyUpAction(c,a):"divscroll"===a.event?a.scrollTop&&d.onRemoteDivScrollAction(c,a.scrollTop):"focusin"===a.event||"blur"===a.event?d.onRemoteFocusAction(c,a):"hoverin"===a.event?d.onRemoteHoverInAction(c):"hoverout"===a.event?d.onRemoteHoverOutAction(c):"change"===a.event?d.onRemoteSelectAction(c,a):"mouseenter"===a.event||"mouseleave"===a.event?d.onRemoteMouseInOutAction(c,a):"refresh"===a.event&&this.startViewSync.call(this,!0)}},getCustomerCoBrowseWindowRecursively:function(a,b){var c=null;if(a){if(b._iframeSelector===a)return b;for(var d=0;d<b._iframes.length&&!(c=this.getCustomerCoBrowseWindowRecursively(a,b._iframes[d]));d++);}return c},getCustomerCoBrowseWindow:function(a,b){return b||(b=this._customerCobrowseWindow),b=this.getCustomerCoBrowseWindowRecursively(a,b),b||(b=this._customerCobrowseWindow),b},onSessionClosedCallBack:function(a){this.shutdown(),this.stopInactiveTimer(),this.onSessionClose({msg:a})},onAgentJoinCallBack:function(a){null!==a&&(this._isAgentJoined=!0,b.extend(this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,a),this.stopViewSync(),this.onAgentJoin(a),this.startOnConnection.call(this))},onMouseSelCallBack:function(a){if(null!==a){var b,c=a.iframeSelector,d=this.getCustomerCoBrowseWindow(c,this._customerCobrowseWindow),e=a.mhighlightText;b=d.cleanHighlightedNode(),e&&e.length>0&&(d.createRangeAndHighlight(e),b=!0),b&&this.startViewSync.call(this,!1)}},inactiveTimeCallBack:function(a){this.rpcInactiveTime(this._customerCobrowse,a)},agentMovedAwayCallBack:function(){this.onAgentDead()},registerCallbacks:function(){this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.ONGETNEXTUPDATE,this.onGetNextViewUpdateCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.ONCONTROLREQUEST,this.onControlRequestCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.ONCONTROLRELEASE,this.onControlReleaseCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.ONREMOTEACTION,this.onRemoteActionCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.ONSESSIONCLOSED,this.onSessionClosedCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.ONMOUSEUPDATE,this.onMousePosCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.ONSCROLLUPDATE,this.onScrollCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.ONAGENTJOIN,this.onAgentJoinCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.ONMOUSESEL,this.onMouseSelCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.INACTIVETIME,this.inactiveTimeCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.AGENTMOVEDAWAY,this.agentMovedAwayCallBack,this)}};b.extend(a.Services.Cobrowse.Customer.CustomerCobrowseService.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";var c={addOnConnectionResetCallback:function(b){this._customerCobrowseService.on(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_ONREADY,b)},removeOnConnectionResetCallback:function(b){this._customerCobrowseService.off(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_ONREADY,b)},addOnConnectionCallback:function(b){this._customerCobrowseService.on(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_START,b)},removeOnConnectionCallback:function(b){this._customerCobrowseService.off(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_START,b)},addOnConnectionFailureCallback:function(b){this._customerCobrowseService.on(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_FAIL,b)},removeOnConnectionFailureCallback:function(b){this._customerCobrowseService.off(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_FAIL,b)},addOnControlRequestCallback:function(b){this._customerCobrowseService.on(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_CONTROLREQUEST,b)},removeOnControlRequestCallback:function(b){this._customerCobrowseService.off(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_CONTROLREQUEST,b)},addOnControlReleaseCallback:function(b){this._customerCobrowseService.on(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_CONTROLRELEASE,b)},removeOnControlReleaseCallback:function(b){this._customerCobrowseService.off(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_CONTROLRELEASE,b)},addOnSessionCloseCallback:function(b){this._customerCobrowseService.on(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_SESSIONCLOSE,b)},removeOnSessionCloseCallback:function(b){this._customerCobrowseService.off(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_SESSIONCLOSE,b)},addOnAgentJoinCallback:function(b){this._customerCobrowseService.on(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_AGENTJOIN,b)},removeOnAgentJoinCallback:function(b){this._customerCobrowseService.off(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_AGENTJOIN,b)},addOnAgentDeadCallback:function(b){this._customerCobrowseService.on(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_AGENTDEAD,b)},removeOnAgentDeadCallback:function(b){this._customerCobrowseService.off(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_AGENTDEAD,b)},addOnfireInactivityCallback:function(a){this._addOnfireInactivityCallbacks.add(a)},removeOnfireInactivityCallback:function(a){this._addOnfireInactivityCallbacks.remove(a)},addOnStopInactivityTimerCallback:function(a){this._addOnStopInactivityTimerCallbacks.add(a)},removeOnStopInactivityTimerCallback:function(a){this._addOnStopInactivityTimerCallbacks.remove(a)},addOnMouseMoveCallback:function(b){this._customerCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_AGENT_MOUSE_UPDATE,b)},removeOnMouseMoveCallback:function(b){this._customerCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_AGENT_MOUSE_UPDATE,b)}};b.extend(a.Services.Cobrowse.Customer.CustomerCobrowse.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";var c={getTextRange:function(){var c=[],d=null,e=null;try{if(this._cbWindow.getSelection?(d=this._cbWindow.getSelection().getRangeAt(0),e=this._cbWindow.getSelection().toString()):this._pageDocument.selection&&"Control"!==this._pageDocument.selection.type&&(d=this._pageDocument.selection().createRange().getRangeAt(0),e=this._pageDocument.selection.createRange().text),!e)return;var f=d.startContainer,g=d.endContainer,h=d.commonAncestorContainer;c[0]=d.startOffset,c[1]=d.endOffset,f&&3===f.TEXT_NODE?(c[2]=b(f.parentNode).getCPath(),c[3]=Array.prototype.indexOf.call(f.parentNode.childNodes,f)):(c[2]=b(f).getCPath(),c[3]=-1),g&&3===g.TEXT_NODE?(c[4]=b(g.parentNode).getCPath(),c[5]=Array.prototype.indexOf.call(g.parentNode.childNodes,g)):(c[4]=b(g).getCPath(),c[5]=-1),c[6]=b(h).getCPathh()}catch(i){a.Base.CobrowseLogger.warn("range error is: "+i.message)}return c},createRangeAndHighlight:function(a){var b=this._pageDocument.find("body"),c=a[0],d=a[1],e=b.find(a[2]).get(0);e||(-1!==a[2].indexOf("html>body>")?e=b.find(a[2].substring("html>body>".length)).get(0):-1!==a[2].indexOf("html > body > ")&&(e=b.find(a[2].substring("html > body > ".length)).get(0)));var f=parseInt(a[3]),g=b.find(a[4]).get(0);g||(-1!==a[4].indexOf("html>body>")?g=b.find(a[4].substring("html>body>".length)).get(0):-1!==a[4].indexOf("html > body > ")&&(g=b.find(a[4].substring("html > body > ".length)).get(0)));var h=parseInt(a[5]);if(e&&g){-1!==f?(e=e.childNodes[f],-1!==h&&(g=g.childNodes[h])):-1!==h&&(g=g.childNodes[h]);for(var i,j=0,k=!0,l=e;k;){if(e.isEqualNode(g))this.traverseChildNodes(e,l,g,c,d),k=!1;else if(i=e,i.nextSibling)i=i.nextSibling;else if(i.parentNode){if(!i.parentNode.nextSibling){e=i.parentNode;continue}i=i.parentNode.nextSibling}else k=!1;k&&(j++,k=this.traverseChildNodes(e,l,g,c,d),e=i)}}},traverseChildNodes:function(c,d,e,f,g){var h,i=!0,j=!1;if(c.isEqualNode(e)&&(i=!1),b.each(this._removeElementList,function(b,d){c.id&&c.id===d&&(a.Base.CobrowseLogger.info("Removing from highlight text=>"+b+":"+d),j=!0)}),!0===j)return i;if(1===c.nodeType)for(c=c.firstChild;c&&(h=c.nextSibling,i=this.traverseChildNodes(c,d,e,f,g));)c=h;else 3===c.nodeType&&(c.nodeValue.trim().length>0||c.wholeText.trim().length>0)&&(c.isEqualNode(d)&&c.isEqualNode(e)?this.wrapMatchesInNode(c,"alone",f,g):c.isEqualNode(e)?this.wrapMatchesInNode(c,"end",f,g):c.isEqualNode(d)?this.wrapMatchesInNode(c,"start",f,g):this.wrapMatchesInNode(c,"",0,0));return i},wrapMatchesInNode:function(c,d,e,f){var g=this,h=c.nodeValue;h||(h=c.wholeText);var i,j=this._customerCobrowseService._isMarkerEnabled,k=this._customerCobrowseService.backgroundColor;if(this._customerCobrowseService.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.agentControlState!==a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE&&j&&(k=this._customerCobrowseService._markerBGColor),"start"===d?(i=h.substring(0,e),i+=j?"<span style='background-color:"+k+"' class = 'cbe_remove_marker'>"+h.substring(e)+"</span>":"<span style='background-color:"+k+"'>"+h.substring(e)+"</span>"):"end"===d?(i=j?"<span style='background-color:"+k+"' class = 'cbe_remove_marker'>"+h.substring(0,f)+"</span>":"<span style='background-color:"+k+"'>"+h.substring(0,f)+"</span>",i+=h.substring(f)):"alone"===d?(i=h.substring(0,e),i+=j?"<span style='background-color:"+k+"' class = 'cbe_remove_marker'>"+h.substring(e,f)+"</span>":"<span style='background-color:"+k+"'>"+h.substring(e,f)+"</span>",i+=h.substring(f)):i=j?"<span style='background-color:"+k+"' class = 'cbe_remove_marker'>"+h+"</span>":"<span style='background-color:"+k+"'>"+h+"</span>",!c.parentNode||"SPAN"!==c.parentNode.nodeName||c.parentNode.style.backgroundColor!==k){var l="cbe_remove",m="<span class= '"+l+"'>"+i+"</span>";this._customerCobrowseService.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.agentControlState!==a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE&&j&&(m=i),b(c).replaceWith(m),this._pageDocument.on("click","span.cbe_remove_marker",function(c){c.stopPropagation(),c.preventDefault(),g._customerCobrowseService.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.agentControlState!==a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE&&b(this).replaceWith(b(this).text())}),this._pageDocument.on("touchend","span.cbe_remove_marker",function(c){c.stopPropagation(),c.preventDefault(),g._customerCobrowseService.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.agentControlState!==a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE&&b(this).replaceWith(b(this).text())})}},cleanHighlightedNode:function(){var a=!1;return this._pageDocument.find(".cbe_remove").each(function(){b(this).replaceWith(function(){return b(this).text()}),a=!0}),a},cleanMarkedNode:function(){var a=!1;return this._pageDocument.find(".cbe_remove_marker").each(function(){b(this).replaceWith(function(){return b(this).text()}),a=!0}),a}};b.extend(a.Services.Cobrowse.Customer.CustomerCobrowseWindow.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";var c={enableMouseSync:function(b){var c=this;this._customerCobrowseWindow.call(this._customerCobrowseWindow.removeLocalNode,"",this._customerCobrowseWindow);var d=!1;if(this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.cobrowseState!==a.Services.Cobrowse.Common.CobrowseState.COBROWSEPAUSEDSTATE&&this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.agentControlState!==a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE||(d=!0),d||!b)return this._mmSyncTimer&&(clearInterval(this._mmSyncTimer),this._mmSyncTimer=void 0),a.Base.CobrowseLogger.info("Skip _mmSync: paused or agentControl"),this._customerCobrowseWindow.call(this._customerCobrowseWindow.unbindEvent,"mousemove",this._customerCobrowseWindow),this._customerCobrowseWindow.call(this._customerCobrowseWindow.unbindEvent,"mouseup",this._customerCobrowseWindow),void this._customerCobrowseWindow.call(this._customerCobrowseWindow.unbindEventWithHandler,"",this._customerCobrowseWindow);this._customerCobrowseWindow.call(this._customerCobrowseWindow.unbindEvent,"mouseup",this._customerCobrowseWindow),this._customerCobrowseWindow.call(this._customerCobrowseWindow.handleMouseUp,"",this._customerCobrowseWindow),this._mmSyncTimer||(this._mmSyncTimer=setInterval(function(){c._mmSync.call(c)},c._mmSyncInterval))},highlightElement:function(a,b){a.focusin(function(){b.highlightIn.call(this,b)}),a.mouseenter(function(){b.highlightIn.call(this,b)}),a.click(function(){b.highlightIn.call(this,b)})},highlightIn:function(c){try{c._mNodeCss=b(this).getCPath(),c._mNodeId=b(this).attr("id")}catch(d){a.Base.CobrowseLogger.error("Exception while highlightIn - "+d)}},_mmSync:function(){if(this._mX!==this._mXO||this._mY!==this._mYO||this._mNodeCss!==this._mNodeCssOld){this._mXO=this._mX,this._mYO=this._mY,this._mNodeCssOld=this._mNodeCss,this._inactiveCounter=0;var c,d,f=0,g=0;if(this._mElement){c=b(this._mElement).offset();try{d=b(this._mElement).getCPath()}catch(e){return void a.Base.CobrowseLogger.info("Error in finding getCPath"+e)}}c&&(parseInt(b(this._mElement).width())>0&&(f=(parseInt(this._mX)-parseInt(c.left))/parseInt(b(this._mElement).width())),parseInt(b(this._mElement).height())>0&&(g=(parseInt(this._mY)-parseInt(c.top))/parseInt(b(this._mElement).height())));var h={event:"mousemove",mX:this._mX,nodeX:f,mY:this._mY,nodeY:g,id:this._mNodeId,cssSelector:this._mNodeCss,nodeCSSSelector:d,iframeSelector:this.iframeSelector};this.rpcSendMousePos(h)}var i=this.getCustomerCoBrowseWindow(this.iframeSelector,this._customerCobrowseWindow);i.doScrollSync.call(i)},onMousePosCallBack:function(a){if(a){this.getCustomerCoBrowseWindow(a.iframeSelector,this._customerCobrowseWindow).onMousePos(a)}},onScrollCallBack:function(a){if(a){this.getCustomerCoBrowseWindow(a.iframeSelector,this._customerCobrowseWindow).onScroll(a)}}};b.extend(a.Services.Cobrowse.Customer.CustomerCobrowseService.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";var c={nameSpace:a.Services.Cobrowse.Customer,updateSVGOnWindowResize:function(){var c=b(document).width()+"px",d=b(document).height()+"px";if(void 0!==this._svg){var e=this._svg[0];e.setAttribute("height",d),e.setAttribute("width",c),a.Base.CobrowseLogger.info("updateSVGOnWindowResize:: new attributes [ height:"+d+"] width: [   newWidth]")}},setDrawType:function(c){var d={},e=b.Deferred(),f={};return void 0!==b("#cbSvg")?(this._drawType=c,d.message="Success",e.resolve(f)):(d.message="Error: Feature not enabled call API enableDrawMode",e.reject(f)),a.Base.CobrowseLogger.info("setDrawType:: [ "+d.message+" ]"),e.promise()},enableDrawMode:function(c){var d=this,e={},f=b.Deferred(),g=!0;try{if(this._coBrowseDataSet.coBrowseData.coBrowseSessionInfo.agentControlState===a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE)e.message="Agent is in control",e.customerControl=!1,g=!1,f.reject(e);else if(c||void 0!==this._svg){if(c&&void 0===this._svg){var h=b(document).width()+"px",i=b(document).height()+"px",j=b('<svg id="cbSvg" overlay="true" mode="none" showing="true" platform="" xmlns="http://www.w3.org/2000/svg" version="1.1"width= "'+h+'" height = "'+i+'"style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; opacity: 0.6; z-index: 2147483644; border: 5px solid brown;"></svg>');b("body").append(j),this._svg=b("#cbSvg"),b("#cbSvg").on("touchstart",function(){return!(d._drawType instanceof d.nameSpace.CustomerDrawShapeRectangle||d._drawType instanceof d.nameSpace.CustomerDrawShapeCircle||d._drawType instanceof d.nameSpace.CustomerDrawFreeHand)||(event.stopPropagation(),event.preventDefault(),d.draw(event),!1)}),b("#cbSvg").on("mousedown",function(a){(d._drawType instanceof d.nameSpace.CustomerDrawShapeRectangle||d._drawType instanceof d.nameSpace.CustomerDrawShapeCircle||d._drawType instanceof d.nameSpace.CustomerDrawFreeHand)&&d.draw(a),a.stopPropagation(),a.preventDefault()})}}else e.message="Error: Feature not enabled call the API enableDrawMode()",f.reject(e);if(g&&void 0!==this._svg){var k=this._svg[0];k.style.display=c?"block":"none",k.style.position="absolute",k.style.zIndex=c?Math.abs(k.style.zIndex):-Math.abs(k.style.zIndex),e.message="Success",c?(b(document).bind("keydown",this.disableTabControl),d._activeElement=b(document.activeElement),b(document.activeElement).blur()):(b(document).unbind("keydown",this.disableTabControl),void 0!==d._activeElement&&d._activeElement.focus()),f.resolve(e)}}catch(l){a.Base.CobrowseLogger.error("enableDrawMode :: [ "+c+" ]"+l.message),e.message="Error: exception occured in the api call",f.reject(e)}return a.Base.CobrowseLogger.info("enableDrawMode:: response [ "+e.message+" ]"),f.promise()},draw:function(b){a.Base.CobrowseLogger.info("draw::start drawing on the page");var c=b.currentTarget;b.stopPropagation();var d,e,f=this,g=Math.round(this.getX(b)+this._svg[0].scrollLeft),h=Math.round(this.getY(b)+this._svg[0].scrollTop),i=f._drawType,j={};j.x=g,j.y=h,i instanceof f.nameSpace.CustomerDrawFreeHand?(j.type="path",d=f.drawShape(j,i),f._svg[0].appendChild(d).setAttribute("id","path_"+j.x)):i instanceof f.nameSpace.CustomerDrawShapeRectangle?(j.type="rect",e=f.drawShape(j,i),f._svg[0].appendChild(e).setAttribute("id","rec_"+j.x)):i instanceof f.nameSpace.CustomerDrawShapeCircle&&(j.type="circle",e=f.drawShape(j,i),f._svg[0].appendChild(e).setAttribute("id","circle_"+j.x)),a.Base.CobrowseLogger.info("draw::added node "+j.type);var k=function(b){try{a.Base.CobrowseLogger.info("draw:: mousemove: drawing the shape");var c=Math.round(f.getX(b)+f._svg[0].scrollLeft),g=Math.round(f.getY(b)+f._svg[0].scrollTop);i instanceof f.nameSpace.CustomerDrawFreeHand&&void 0!==d?d.setAttribute("d",d.getAttribute("d")+" L"+c+","+g):i instanceof f.nameSpace.CustomerDrawShapeRectangle&&void 0!==e?c-j.x>=0&&g-j.y>=0&&(e.setAttribute("width",c-j.x),e.setAttribute("height",g-j.y)):i instanceof f.nameSpace.CustomerDrawShapeCircle&&void 0!==e&&c-j.x>=0&&e.setAttribute("r",c-j.x)}catch(h){a.Base.CobrowseLogger.info("draw:: mousemove: negative value")}},l=function(b){return a.Base.CobrowseLogger.info("draw:: touchmove: drawing the shape"),b.stopPropagation(),b.preventDefault(),k(b),!1},m=function(b){a.Base.CobrowseLogger.info("draw:: mouseup"),f._svg[0].removeEventListener("mousemove",k),f._svg[0].removeEventListener("mouseup",m),c.removeEventListener("touchmove",l),c.removeEventListener("touchend",n)},n=function(a){return a.stopPropagation(),a.preventDefault(),m(a),!1};this._svg[0].addEventListener("mousemove",k),this._svg[0].addEventListener("mouseup",m),c.addEventListener("touchmove",l),c.addEventListener("touchend",n)},addEvent:function(a,b){a.addEventListener(b,function(){a.parentNode.removeChild(a)})},drawShape:function(b,c){a.Base.CobrowseLogger.info("drawShape:: draw shape [ "+b.type+" ]");var d=this,e=document.createElementNS("http://www.w3.org/2000/svg",b.type);return e.setAttribute("stroke",c._sColor),e.setAttribute("stroke-width",c._sSize+"px"),e.setAttribute("fill","none"),c instanceof d.nameSpace.CustomerDrawFreeHand?(e.setAttribute("d","M"+b.x+","+b.y),d.addEvent(e,"click"),d.addEvent(e,"touchend")):c instanceof d.nameSpace.CustomerDrawShapeRectangle?(e.setAttribute("x",b.x),e.setAttribute("y",b.y),e.setAttribute("width","0"),e.setAttribute("height","0"),d.addEvent(e,"click"),d.addEvent(e,"touchend")):c instanceof d.nameSpace.CustomerDrawShapeCircle&&(e.setAttribute("cx",b.x),e.setAttribute("cy",b.y),e.setAttribute("r",0),d.addEvent(e,"click"),d.addEvent(e,"touchend")),e},clear:function(){void 0!==this._svg&&(b("#cbSvg").empty(),a.Base.CobrowseLogger.info("clear:: Erased all the drawing"))},getX:function(a){return(a.pageX&&a.pageX>0?a.pageX:a.touches[0].pageX)-this._offsetX},getY:function(a){return(a.pageY&&a.pageY>0?a.pageY:a.touches[0].pageY)-this._offsetY}};b.extend(a.Services.Cobrowse.Customer.CustomerCobrowseService.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";var c={_configurePsuedo:function(){this._psuedoCollection||(this._psuedoCollection=this._vGetPsuedoElements(this._customerCobrowseService._inputJsonForPsuedo)),this._psuedoCollection&&this._psuedoCollection.psuedo&&this._psuedoCollection.psuedo.length>0&&this._vbindJSForPseudo(this._psuedoCollection)},_vAddPsuedoCSS:function(a){var c=a.psuedo,d="";b.each(c,function(a,c){var e=[],f=c.style.split(";");b.each(f,function(a,b){"}"!==b.trim()?e.push(b+" !important"):e.push(b)}),c.hoverOn?d+="."+c.hoverOn.split(".").join("").split(" ").join("").split(">").join("").split("#").join("").split(":").join("").split("(").join("").split(")").join("")+c.styleFor.split(" ").join("").split(">").join("").split(".").join("").split("#").join("").split(":").join("").split("(").join("").split(")").join("")+"_hovered"+e.join(";"):c.activeOn?d+="."+c.activeOn.split(".").join("").split(" ").join("").split(">").join("").split("#").join("").split(":").join("").split("(").join("").split(")").join("")+c.styleFor.split(" ").join("").split(">").join("").split(".").join("").split("#").join("").split(":").join("").split("(").join("").split(")").join("")+"_active"+e.join(";"):c.targetOn&&(d+="."+c.targetOn.split(".").join("").split(" ").join("").split(">").join("").split("#").join("").split(":").join("").split("(").join("").split(")").join("")+c.styleFor.split(" ").join("").split(">").join("").split(".").join("").split("#").join("").split(":").join("").split("(").join("").split(")").join("")+"_targeted"+e.join(";"))}),this._cssForAgentHoverSupport="<style type='text/css' id='addedByAutomation'>"+d+"</style>"},_vUniquePsuedoElemtns:function(a){var b=[];return a.forEach(function(a){var c=!0;a?b.forEach(function(b){a.selectorText===b.selectorText&&a.style===b.style&&(c=!1)}):c=!1,c&&b.push(a)}),b},_processCSSSheet:function(a){String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return this.substr(b||0,a.length)===a});var c=[],d=a.cssRules;return b.each(d,function(a,d){if(d.selectorText&&d.selectorText.split(":").length>1){if(d.selectorText.split("::")[1])return!0;var e=d.selectorText.split(",");if(e.length>1)b.each(e,function(a,b){if(b.split(":").length>1){var e=b.split(":"),f={};e[1].startsWith("hover")?(f.selectorText=b,f.hoverOn=e[0],f.style=d.cssText.split(d.selectorText)[1],f.styleFor=b.split(":hover")[1],f.psuedo="hover",c.push(f)):e[1].startsWith("active")?(f.selectorText=b,f.activeOn=e[0],f.style=d.cssText.split(d.selectorText)[1],f.styleFor=b.split(":active")[1],f.psuedo="active",c.push(f)):e[1].startsWith("target")?(f.selectorText=b,f.targetOn=e[0],f.style=d.cssText.split(d.selectorText)[1],f.styleFor=b.split(":target")[1],f.psuedo="target",c.push(f)):e[1].startsWith("valid")&&(f.selectorText=b,f.hoverOn=e[0],f.style=d.cssText.split(d.selectorText)[1],f.styleFor=b.split(":valid")[1],f.psuedo="valid",c.push(f))}});else{var f=d.selectorText.split(":"),g={};f[1].startsWith("hover")?(g.selectorText=d.selectorText,g.hoverOn=f[0],g.style=d.cssText.split(d.selectorText)[1],g.styleFor=d.selectorText.split(":hover")[1],c.push(g)):f[1].startsWith("active")?(g.selectorText=d.selectorText,g.activeOn=f[0],g.style=d.cssText.split(d.selectorText)[1],g.styleFor=d.selectorText.split(":active")[1],g.psuedo="active",c.push(g)):f[1].startsWith("target")?(g.selectorText=d.selectorText,g.targetOn=f[0],g.style=d.cssText.split(d.selectorText)[1],g.styleFor=d.selectorText.split(":target")[1],g.psuedo="target",c.push(g)):f[1].startsWith("valid")&&(g.selectorText=d.selectorText,g.validOn=f[0],g.style=d.cssText.split(d.selectorText)[1],g.styleFor=d.selectorText.split(":valid")[1],g.psuedo="valid",c.push(g))}}}),c},_vGetPsuedoElements:function(c){var d=this,e={},f=[];if(void 0!==c){var g;try{if(g=JSON.parse(c),void 0===g.css)throw{
message:"Illegal argument"}}catch(i){return void a.Base.CobrowseLogger.error("Illegal argument, Read API documentation on seCSSHoverFile usage.")}String.prototype.includes||(String.prototype.includes=function(a,b){return"number"!=typeof b&&(b=0),!(b+a.length>this.length)&&-1!==this.indexOf(a,b)});var h=b(this._pageDocument.get(0).styleSheets);return b.each(h,function(c,e){try{e.href&&e.cssRules&&(g.css?b.each(g.css,function(a,c){e.href.includes(c)&&b.each(d._processCSSSheet(e),function(a,b){f.push(b)})}):""===g.css&&b.each(d._processCSSSheet(e),function(a,b){f.push(b)}))}catch(h){a.Base.CobrowseLogger.error("Error processing this CSS")}}),f.length>0&&(e.psuedo=this._vUniquePsuedoElemtns(f),this._vAddPsuedoCSS(e)),e}},_bindForValid:function(a){},_bindForTarget:function(a){var c="";if(!(!a||a&&a.psuedo&&0===a.psuedo.length)){var d=a.psuedo,e=this;b.each(d,function(a,d){d.targetOn&&(c=""===d.styleFor?d.targetOn.split(".").join("").split(" ").join("").split(">").join("").split("#").join("").split(":").join("").split("(").join("").split(")").join("")+"_targeted":d.targetOn.split(".").join("").split(" ").join("").split(">").join("").split("#").join("").split(":").join("").split("(").join("").split(")").join("")+d.styleFor.split(" ").join("").split(">").join("").split(".").join("").split("#").join("").split(":").join("").split("(").join("").split(")").join("")+"_targeted",e._customerCobrowseService._customerCobrowseWindow._iframes.length>0&&b.each(e._customerCobrowseService._customerCobrowseWindow._iframes,function(a,b){b._pageDocument.find(d.targetOn).siblings("a").on("click",{addThis:c},function(a){if(""===d.styleFor){var c=this.getAttribute("href");b._pageDocument.find(d.targetOn+":target").parent().children().removeClass(a.data.addThis),b._pageDocument.find(d.targetOn+c).addClass(a.data.addThis)}})}),b(d.targetOn).siblings("a").on("click",{addThis:c},function(a){if(""===d.styleFor){var c=this.getAttribute("href");b(d.targetOn+":target").parent().children().removeClass(a.data.addThis),b(d.targetOn+c).addClass(a.data.addThis)}}),c="")})}},_bindForActive:function(a){var c="";if(!(!a||a&&a.psuedo&&0===a.psuedo.length)){var d=this,e=a.psuedo;b.each(e,function(a,e){e.activeOn&&(c=""===e.styleFor?e.activeOn.split(".").join("").split(" ").join("").split(">").join("").split("#").join("").split(":").join("").split("(").join("").split(")").join("")+"_active":e.activeOn.split(".").join("").split(" ").join("").split(">").join("").split("#").join("").split(":").join("").split("(").join("").split(")").join("")+e.styleFor.split(" ").join("").split(">").join("").split(".").join("").split("#").join("").split(":").join("").split("(").join("").split(")").join("")+"_active",d._customerCobrowseService._customerCobrowseWindow._iframes.length>0&&b.each(d._customerCobrowseService._customerCobrowseWindow._iframes,function(a,d){d._pageDocument.find(e.activeOn).on("mousedown",{addThis:c},function(a){""===e.styleFor?b(this).addClass(a.data.addThis):b(this).find(e.styleFor).addClass(a.data.addThis)})}),b(e.activeOn).on("mousedown",{addThis:c},function(a){""===e.styleFor?b(this).addClass(a.data.addThis):b(this).find(e.styleFor).addClass(a.data.addThis)}),d._customerCobrowseService._customerCobrowseWindow._iframes.length>0&&b.each(d._customerCobrowseService._customerCobrowseWindow._iframes,function(a,d){d._pageDocument.find(e.activeOn).on("mouseup",{addThis:c},function(a){""===e.styleFor?b(this).addClass(a.data.addThis):b(this).find(e.styleFor).addClass(a.data.addThis)})}),b(e.activeOn).on("mouseup",{addThis:c},function(a){""===e.styleFor?b(this).removeClass(a.data.addThis):b(this).find(e.styleFor).removeClass(a.data.addThis)}),c="")})}},_bindForHover:function(a){var c="";if(!(!a||a&&a.psuedo&&0===a.psuedo.length)){var d=a.psuedo,e=this;b.each(d,function(a,d){d.hoverOn&&(c=""===d.styleFor?d.hoverOn.split(".").join("").split(" ").join("").split(">").join("").split("#").join("").split(":").join("").split("(").join("").split(")").join("")+"_hovered":d.hoverOn.split(".").join("").split(" ").join("").split(">").join("").split("#").join("").split(":").join("").split("(").join("").split(")").join("")+d.styleFor.split(" ").join("").split(">").join("").split(".").join("").split("#").join("").split(":").join("").split("(").join("").split(")").join("")+"_hovered",e._customerCobrowseService._customerCobrowseWindow._iframes.length>0&&b.each(e._customerCobrowseService._customerCobrowseWindow._iframes,function(a,e){e._pageDocument.find(d.hoverOn).on("mouseenter",{addThis:c},function(a){""===d.styleFor?b(this).addClass(a.data.addThis):b(this).find(d.styleFor).addClass(a.data.addThis)})}),b(d.hoverOn).on("mouseenter",{addThis:c},function(a){""===d.styleFor?b(this).addClass(a.data.addThis):b(this).find(d.styleFor).addClass(a.data.addThis)}),e._customerCobrowseService._customerCobrowseWindow._iframes.length>0&&b.each(e._customerCobrowseService._customerCobrowseWindow._iframes,function(a,e){e._pageDocument.find(d.hoverOn).on("mouseleave",{addThis:c},function(a){""===d.styleFor?b(this).removeClass(a.data.addThis):b(this).find(d.styleFor).removeClass(a.data.addThis)})}),b(d.hoverOn).on("mouseleave",{addThis:c},function(a){""===d.styleFor?b(this).removeClass(a.data.addThis):b(this).find(d.styleFor).removeClass(a.data.addThis)}),c="")})}},_vbindJSForPseudo:function(a){this._bindForHover(a),this._bindForActive(a),this._bindForTarget(a),this._bindForValid(a)},_unbindForHover:function(a){if(!(!a||a&&a.psuedo&&0===a.psuedo.length)){var c=a.psuedo;b.each(c,function(a,c){"hover"===c.psuedo&&(b(c.hoverOn).off("mouseenter"),b(c.hoverOn).off("mouseleave"))})}},_unbindForActive:function(){},_unbindForTarget:function(){},_unbindForValid:function(){},_vUnbindJSForPseudo:function(){this._psuedoCollection&&(this._unbindForHover(this._psuedoCollection),this._unbindForActive(this._psuedoCollection),this._unbindForTarget(this._psuedoCollection),this._unbindForValid(this._psuedoCollection))}};b.extend(a.Services.Cobrowse.Customer.CustomerCobrowseWindow.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";var c={createRequestSessionArguments:function(){return{apikey:"defaultapikey",name:void 0,autoJoin:!0,locale:"en_US",emailid:void 0,useragent:void 0,eurl:void 0}},createJoinSessionArguments:function(){return{sessionkey:void 0,name:void 0,locale:"en_US",emailid:void 0,useragent:void 0}},createStatusArguments:function(){return{acstoken:void 0}},createLogoutSessionArguments:function(){return{acstoken:void 0,reason:"logout",eurl:void 0}}};b.extend(a.Services.Cobrowse.Customer.CustomerCobrowse.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";var c={createCobrowseWindow:function(d,e){var f=b(d._pageDocument).find("iframe");f&&f.length>0&&b.each(f,function(f,g){try{var h=e.getIframeSelectorId(d)+f;b(this).contents().off("mousemove.cbiframeid"),b(this).contents().on("mousemove.cbiframeid",function(a){e.iframeSelector=h});var i=new a.Services.Cobrowse.Customer.CustomerCobrowseWindow(b(g).contents(),e,h,g.contentWindow);c.createCobrowseWindow(i,e),d.addIframeWindow(i)}catch(j){a.Base.CobrowseLogger.error("error in createCobrowseWindow : "+j)}})},getIframeSelectorId:function(a){return a._iframeSelector&&"main"===a._iframeSelector?"iframe":a._iframeSelector},startOnConnection:function(){var c="main",d=this;this._customerCobrowseWindow=new a.Services.Cobrowse.Customer.CustomerCobrowseWindow(b(document),this,c,window),b(document).off("mousemove.cbiframeid"),b(document).on("mousemove.cbiframeid",function(a){d.iframeSelector=c}),this.createCobrowseWindow(this._customerCobrowseWindow,this),this._isDropDownEnable&&this._customerCobrowseWindow.call(this._customerCobrowseWindow.dropdownSupport,"",this._customerCobrowseWindow),this.enableMouseSync.call(this,!0),this._customerCobrowseWindow.call(this._customerCobrowseWindow._configurePsuedo,"",this._customerCobrowseWindow),this._updateOnWindowResize(),this.startViewSync.call(this,!1),this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.agentControlState===a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE?this._updateOnCtrlChg(!0):this._updateOnCtrlChg(!1),this._customerCobrowseWindow.call(this._customerCobrowseWindow.refreshMaskElements,"",this._customerCobrowseWindow)},_updateOnCtrlChg:function(a){this._customerCobrowseWindow.call(this._customerCobrowseWindow.updateOnCtrlChg,a,this._customerCobrowseWindow)},disableTabControl:function(b){9===b.keyCode&&(a.Base.CobrowseLogger.log("Event tab recieved, killing it"),b.preventDefault())},startViewSync:function(b){if(this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.cobrowseState===a.Services.Cobrowse.Common.CobrowseState.COBROWSEPAUSEDSTATE)return void(this._vSyncTimer&&clearTimeout(this._vSyncTimer));this._customerCobrowseWindow.call(this._customerCobrowseWindow.startViewSync,b,this._customerCobrowseWindow)},vSyncTimerFunc:function(){this.startViewSync.call(this,!1)},getBaseURL:function(){return this._customerCobrowseWindow.getBaseURL()},getDomainURL:function(){return window.location.protocol+"//"+window.location.hostname},getCurrentURL:function(){return encodeURI(Base64.encode(window.location.href))},shutdown:function(){this._customerCobrowseWindow&&(this._customerCobrowseWindow.call(this._customerCobrowseWindow.cleanOnShutdown,"",this._customerCobrowseWindow),this._updateOnCtrlChg(!1),this.enableDrawMode(!1),this.enableMouseSync.call(this,!1)),this.stopViewSync(),this.getCustomerDataSet().coBrowseData=new a.Base.CobrowseData,this._customerCobrowseProvider.stopSocketConnection(),a.Base.CobrowseCookie.erase("ACS_TOKEN"),this.stopInactiveTimer(),this._customerCobrowseWindow&&(this._customerCobrowseWindow.call(this._customerCobrowseWindow._vUnbindJSForPseudo,"",this._customerCobrowseWindow),this._customerCobrowseWindow.call(this._customerCobrowseWindow.removeDropdownSupport,"",this._customerCobrowseWindow))},stopViewSync:function(){clearTimeout(this._vSyncTimer),this._customerCobrowseWindow&&this._customerCobrowseWindow.call(this._customerCobrowseWindow.setViewEmpty,"",this._customerCobrowseWindow),this._ctrlReqPending=!1},repeatedViewSync:function(){var a=this;a.startViewSync.call(a,!1),0!==a._agentViewSyncInterval&&(setTimeout(function(){a.startViewSync.call(a,!1)},a._agentViewSyncInterval),setTimeout(function(){a.startViewSync.call(a,!1)},3*a._agentViewSyncInterval))},highlight:function(c){var d="cbe-highlight";b(c).is("img")&&(d="cbe-highlight-img");try{this._mLocalNode=b('<div id="cbeHighlightId"></div>').addClass(d).css({top:b(c).offset().top-4+"px",left:b(c).offset().left-4+"px",width:b(c).outerWidth()+6+"px",height:b(c).outerHeight()+6+"px"})}catch(e){a.Base.CobrowseLogger.error("error in highlighting node : "+e)}return this._mLocalNode},highlightOnAgentTouch:function(a){a.addClass("cbe-radio-agent-touch")},onMousePos:function(a){if(null!==a){this.getCustomerCoBrowseWindow(a.iframeSelector,this._customerCobrowseWindow).onMousePos(a)}},startInactiveTimer:function(){this.resetInactiveCounter(),a.Base.CobrowseLogger.info("START INACTIVE TIMER START FOR CUSTOMER "),this._inactiveTimer&&(clearInterval(this._inactiveTimer),this._inactiveTimer=void 0);var b=this;this._inactiveTimer=setInterval(function(){b.incInactiveCounter(),b._inactiveCounter>60*b.getCustomerDataSet().coBrowseData.options["CB.INACTIVE_TIMEOUT"]&&(b._customerCobrowse._addOnfireInactivityCallbacks.fire(b.getCustomerDataSet().coBrowseData.options["CB.INACTIVE_TIMEOUT_MESSAGE"]),a.Base.CobrowseLogger.info("fire _onCobrowseRequestSuccessCallbacks "),b.resetInactiveCounter())},b._inactiveInterval)},stopInactiveTimer:function(){a.Base.CobrowseLogger.info(" STOP INACTIVE TIMER ");var b=this;b._inactiveTimer&&(clearInterval(b._inactiveTimer),b._inactiveTimer=void 0),b.resetInactiveCounter(),a.Base.CobrowseLogger.info("fire _addOnStopInactivityTimerCallbacks "),b._customerCobrowse._addOnStopInactivityTimerCallbacks.fire(b._customerCobrowse)},resetInactiveCounter:function(){this._inactiveCounter=0,a.Base.CobrowseLogger.info("RESET COUNTER  "+this._inactiveCounter)},incInactiveCounter:function(){a.Base.CobrowseLogger.info("Increment Inactive Counter "+this._inactiveCounter),this._inactiveCounter=this._inactiveCounter+5},addElementIDToRemove:function(a){this._removeElementList.push(a)},enableHighlight:function(a){this._isHighilightEnabled=a},enableMarker:function(a){this._isMarkerEnabled=a},enableTitle:function(a){this._isTitleEnable=a},setHighlightColor:function(a){this.backgroundColor=a},setMarkerColor:function(a){this._markerBGColor=a},setMouseAndScrollSyncInterval:function(a){this._mmSyncInterval=a},setConnectionRetryInterval:function(a){this._connRetryInterval=a},setAgentViewSyncInterval:function(a){this._vSyncInterval=a},onDemandUpdate:function(){a.Base.CobrowseLogger.info("Pushing OnDemand Dom Update to Agent "),this._customerCobrowseWindow.call(this._customerCobrowseWindow.setViewEmpty,"",this._customerCobrowseWindow),this.updateSVGOnWindowResize(),this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.agentControlState===a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE?this.startViewSync.call(this,!0):this.startViewSync.call(this,!1)},_updateOnWindowResize:function(){this._customerCobrowseWindow.call(this._customerCobrowseWindow.updateOnWindowResize,"",this._customerCobrowseWindow)}};b.extend(a.Services.Cobrowse.Customer.CustomerCobrowseService.prototype,c)}(AvayaCoBrowseClientServices,jQuery);