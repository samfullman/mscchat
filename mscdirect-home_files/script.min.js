var MSCJS=MSCJS||{};var IframeShim={output:function(c){if(navigator.userAgent.match(/msie /i)){var b=c,a='<iframe class="shim" frameborder="0" src="javascript:\'\';" style="display: block;position: absolute;top:'+b.css("top")+";bottom:"+b.css("bottom")+";left:"+b.css("left")+";right:"+b.css("right")+";width:"+b.outerWidth()+"px;height:"+b.outerHeight()+'px;z-index:-1;"></iframe>';b.before(a)}},destroy:function(a){$(a).find("iframe.shim").remove()}};MSCJS.Navigation=function(){$("#navigation li").each(function(){$(this).hover(function(){if($(this).children(".tier1").length>0){$(this).addClass("hover");IframeShim.output($(this).children(".tier1"))}},function(){if($(this).children(".tier1").length>0){$(this).removeClass("hover");IframeShim.destroy($(this))}})})};(function(a){a.fn.watermark=function(b,c){return this.each(function(){var d=a(this);d.addClass(b).data("w",1).val(c).focus(function(){if(d.val()===c){d.removeClass(b).val("")}}).blur(function(){if(d.val()===""){d.addClass(b).val(c)}})})};a.fn.removeWatermark=function(){return this.each(function(){a(this).data("w")&&a(this).val("")})}})(jQuery);MSCJS.loginModal=function(){var a=$(".uMyAcctLeft");a.hover(function(){$(this).addClass("active");$(".loginForm",this).removeClass("visuallyhidden")},function(f){var d=$(".loginForm",this);var g=d.offset();var c=d.width();var b=d.height();if(f.pageX<g.left||f.pageX>(g.left+c)||f.pageY<g.top||f.pageY>(g.top+b)){if($("li.uMyAcctLeft > a.accountLoginLink").length>0){$("body").click(function(){$("#hdrUsername",a).blur();$(".loginForm",a).addClass("visuallyhidden");a.removeClass("active")})}else{$("#hdrUsername",this).blur();d.addClass("visuallyhidden");$(this).removeClass("active")}}if($("li.uMyAcctLeft > a.accountLoginLink").length>0){$(".loginForm").click(function(e){e.stopPropagation()})}});$(".close",a).click(function(){$("#hdrUsername",a).blur();$(".loginForm",a).addClass("visuallyhidden");a.removeClass("active")})};MSCJS.setHeight=function(){var b=0;var c=[];var a=0;if($(".sameHeightColumn").length>1){$(".sameHeightColumn").each(function(){$(this).css("height","auto");var d=$(this).height();c.push(d);if(d>b){b=d}});$(".sameHeightColumn").each(function(){if($(this).children(".innerSameHeightColumn").length>0){$(this).children(".innerSameHeightColumn").each(function(){$(this).height(b-c[a]+$(this).outerHeight(true))})}else{a++;$(this).height(b)}})}};MSCJS.filter={filter:function(a){if(a==="Alphabetical"){$(".slider-item").tsort("img",{order:"asc",attr:"alt"})}else{$(".slider-item").each(function(){if($(this).hasClass(a)&&$(this).is(":hidden")){$(this).fadeIn()}else{if(!$(this).hasClass(a)){$(this).fadeOut()}}})}},init:function(){$(".prodNavigation li a").click(function(b){b.preventDefault();var a=$(this).attr("href").split("#")[1];MSCJS.filter.filter(a)})}};MSCJS.miniCartShow=function(b,d){var c=$("#"+d);c.html(b);c.show().focus();var a=setTimeout(function(){c.fadeOut()},5000);$("#"+d).find(".close").click(function(f){f.preventDefault();clearTimeout(a);c.fadeOut()})};MSCJS.miniCartShowApi=function(b){var c=$("#miniCart");c.html(b);c.show().focus();var a=setTimeout(function(){c.fadeOut()},5000);$("#miniCart").find(".close").click(function(d){d.preventDefault();clearTimeout(a);c.fadeOut()})};MSCJS.IEzIndexFix=function(){if(navigator.userAgent.match(/msie [7]/i)){$("#userEnteredPartnumber1").focus(function(){$(".quickOrderItem").css("position","static")});$("#userEnteredPartnumber2").focus(function(){$(".quickOrderItem").css("position","relative")});$(".inputArea .itemNumber").focus(function(){var b=$(this).offset();var a=b.top-298;$(".orderpaditem .typeAheadDisplay").css("top",a+"px")})}};MSCJS.zIndexBookFix=function(){if(window.location=="http://localhost.mscdirect.com/FlyerView?contentPath=/sales-catalogs/big-book"){var a=1000;$(".tier1").each(function(){$(this).css("zIndex",a);a-=10})}};$(document).ready(function(){$(".watermarked").each(function(){var b=$(this).attr("title");var a=$.trim($(this).val());if(!a){$(this).watermark("watermark",b)}});$("input#siteSearchInput").focusout(function(){if($(this).val()==""){$("input#siteSearchInput").val($("input#siteSearchInput").attr("title"))}});$("input#siteSearchInput").bind("keyup",function(){if($(this).val()==$(this).attr("title")){$("input#siteSearchInput").val("")}if($(this).val()==""){$("#icon_clear").hide()}else{if($(this).val()!=$(this).attr("title")){$("#icon_clear").show()}}});$("#icon_clear").bind("click",function(){$("#icon_clear").prev("input").val("");$("#icon_clear").hide();$("input#siteSearchInput").focus()});if($("input#siteSearchInput").val()!=$("input#siteSearchInput").attr("title")){$("#icon_clear").show()}else{$("#icon_clear").hide()}});$(window).load(function(){MSCJS.setHeight();MSCJS.IEzIndexFix();MSCJS.zIndexBookFix();if($("#epcode").length>0&&($("#epcode").val()!="")&&tealiumFlag){sendTagsForPromoAdd($("#epcode").val().toLowerCase(),"email auto-add")}});function verifyPartNumber(){if(($("#searchterm").val()=="")||$("#searchterm").val().length<8||($("#searchterm").val().length>8&&$("#searchterm").val().length<11)){$("#msdsDetails").hide();$("#msdsError").html('<p class="error">Please enter a valid MSC part number</p>');return false}else{if($("#searchterm").val().length==11&&$("#searchterm").val()!=""){var d=$("#searchterm").val();var f=d.substring(3,11);var e=d.substring(0,3);if(e!="PRO"){$("#msdsDetails").hide();$("#msdsError").html('<p class="error">Please enter a valid MSC part number</p>');return false}else{if(isNaN(f)){$("#msdsDetails").hide();$("#msdsError").html('<p class="error">Please enter a valid MSC part number</p>');return false}else{if(d.startsWith("PRO")){$("#searchterm").val(d);}else{$("#searchterm").val(f);}}}}else{$("#goButton").attr("disabled","disabled");$("#msdsError").hide()}}}function autoApplyPromo(o){var m=/^[a-zA-Z0-9-, ]*$/;var i=o;var p="N";if(m.test(i)==true){var l=i.split(",");for(var n=0;n<l.length;n++){if(l[n].length>10){$("#promoError").html('<p class="error"> Invalid PromoCode.</p>');return false}}try{var r=$.ajax({url:"/CreateAutoPromoSessionController",data:"promoCode="+i,type:"POST",async:false,dataType:"text"}).responseText;var s=$.parseJSON(r);if(s){if(s.responseMsg=="Y"){var t=window.location.pathname}if(t.indexOf("/ShoppingCartView")!=-1||t.indexOf("/ApplyPromotionCode")!=-1){if(t.indexOf("/ShoppingCartView")!=-1){window.location.reload()}else{if(t.indexOf("/ApplyPromotionCode")!=-1){window.location.href="/ShoppingCartView"}}}if(s.responseMsg=="Y"){p="Y";if(tealiumFlag){sendTagsForPromoAdd(o.toLowerCase(),"auto-add")}}else{p="N"}}}catch(q){p="N"}}return p}function validateInputFileds(m){var l=/^\s*[a-zA-Z0-9\s-_]+\s*$/;var p=false;var r=false;var t=false;var s=$(m).val();var q=m+"ReqErr";var o=m+"SpecialErr";var k=$(m).position().top;var n=$(m).position().left;$(m+"ReqErr").css("top",k+10);$(m+"ReqErr").css("left",n+210);$(m+"SpecialErr").css("top",k+10);$(m+"SpecialErr").css("left",n+210);if(!l.test(s)){if($.trim(s)==null||$.trim(s)==""){p=true;r=false;t=true}else{p=false;r=true;t=false}}else{r=false;p=false;t=false;$(m).removeClass("err_box_new");if($.trim(s)==null||$.trim(s)==""){p=true;t=true;$(m).addClass("err_box_new")}}if(t&&p){if(m=="#listName"){$("#listNameReqErr").show();$("#listDescReqErr").hide();$("#listNameSpecialErr").hide();$("#listDescSpecialErr").hide();$(m).addClass("err_box_new");return false}if(m=="#listDesc"){$("#listDescReqErr").show();$("#listNameReqErr").hide();$("#listNameSpecialErr").hide();$("#listDescSpecialErr").hide();$(m).addClass("err_box_new");return false}}else{$(q).hide()}if(r&&!t){if(m=="#listName"){$("#listNameSpecialErr").show();$("#listDescSpecialErr").hide();$("#listDescReqErr").hide();$("#listNameReqErr").hide();$(m).addClass("err_box_new");return false}if(m=="#listDesc"){$("#listDescSpecialErr").show();$("#listNameSpecialErr").hide();$("#listDescReqErr").hide();$("#listNameReqErr").hide();$(m).addClass("err_box_new");return false}}else{$(o).hide()}return true}function validationOnSubmit(){if($.trim($("#listName").val())==""||$.trim($("#listDesc").val())==""){var d;if($.trim($("#listName").val())==""){$("#listName").addClass("err_box_new")}if($.trim($("#listDesc").val())==""){$("#listDesc").addClass("err_box_new")}if($.trim($("#listName").val())==""){d="#listName"}else{d="#listDesc"}}var c=validateInputFileds("#listName");if(c){c=validateInputFileds("#listDesc")}return c}function validationOnBlurAndFocus(){$("#listName").blur(function(){validateInputFileds("#listName")});$("#listDesc").blur(function(){validateInputFileds("#listDesc")});$("#listName").focus(function(){if(($(this).hasClass("err_box_new"))){validateInputFileds("#listName")}});$("#listDesc").focus(function(){if(($(this).hasClass("err_box_new"))){validateInputFileds("#listDesc")}})};